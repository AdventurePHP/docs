<doku:title parent="119" tags="documentation,class reference,classes,reference,singleton,sessionsingleton" title="Singleton / SessionSingleton" urlname="Singleton-SessionSingleton">
  The adventure php framework implements two special ways of the design pattern: an abstract singleton
  class and an abstract session singleton class. Both of them offer the ability to create any class
  in singleton style. The singleton pattern is also used in the serviceManager component due to
  performance reasons. The session singleton implementation creates singleton objects, that are
  available within a (PHP) session in singleton style.
</doku:title>
The singleton pattern is a widly used pattern. It belongs to the family of creational patterns and
is often used to to make available information or functionality just once within a entire
application. In case of software layering, the singleton pattern commonly is used to create service
layers only once to get bettern performance during executing business processes or load and save
data structures.
<br />
<br />
The adventure php framework implements two special ways of the design pattern: an abstract singleton
class and an abstract session singleton class. Both of them offer the ability to create <strong>any
class</strong> in singleton style. The singleton pattern is also used in the serviceManager component
due to performance reasons. The session singleton implementation creates singleton objects, that are
available within a (PHP) session in singleton style.
<br />
<br />
<br />
<h3 id="Chapter-1-Singleton"><a href="#Chapter-1-Singleton">1. Singleton</a></h3>
Due to the fact, that the singleton pattern is deeply interweaved with the framework, this class must
not be imported explicitly. To create any class in singleton style, every time, the class must fetched
using the following code snippet:
<gen:highlight type="php">
  $Object = &Singleton::getInstance('{ClassName}');
</gen:highlight>
If your application is based on the PHP 5 version you can leave the <strong>&</strong>, because
values are automatically returned by reference.
<br />
<br />
<br />
<h3 id="Chapter-2-SessionSingleton"><a href="#Chapter-2-SessionSingleton">2. SessionSingleton</a></h3>
In order to utilize the <strong>SessionSingleton</strong> class, it must first be imported via
<gen:highlight type="php">
  import('core::singleton','SessionSingleton');
</gen:highlight>
Further any object can be created in session singleton style by adding
<gen:highlight type="php">
  $Objekt = &SessionSingleton::getInstance('{ClassName}');
</gen:highlight>
to your code. Please note, that PHP 4 users must add the <strong>&</strong>.
<br />
<br />
<br />
<h3 id="Chapter-3-ServiceManager-usage"><a href="#Chapter-3-ServiceManager-usage">3. Usage of the serviceManagers</a></h3>
As already mentioned above, every class, that inherits from <strong>coreObject</strong> features
wrapper methods for creating singleton and of version 1.5.1 creating session singleton service
layers. You are provided two different possibilities: simple service objects and pre-initialized
objects. Generally, standard singleton objects meet the needs of the application. In more complex
applications the service layers often need to be initialized prior to use.
<br />
<br />
Since version 1.5.1 both methods are provided with another optional argument, that indicates the
way, the service object is created.
<br />
<br />
A "service object" or "service layer" commonly is an instance of any kind of class, that provides
a kind of service to another software layer. Here, software layer is a notion, that is described by
the <strong>three tier architecture</strong> pattern. In case of a business layer communicating
with the data layer, the latter is called a "service layer" for the business layer.
<br />
<br />
<br />
<h4 id="Chapter-3-1-getServiceObject"><a href="#Chapter-3-1-getServiceObject">3.1. __getServiceObject()</a></h4>
Merely, the follwing code part can be used ton create service objects:
<gen:highlight type="php">
  $SL = &$this->__getServiceObject('service::layer::namespace','ServiceLayerClassName','{MODE}');
</gen:highlight>
<strong>{MODE}</strong> must be filled with on of the values presented in the list below:
<ul>
  <li><strong>NORMAL</strong>: Class will be created and configured "normally"</li>
  <li><strong>SINGLETON</strong>: Class will be created and configured "singleton"</li>
  <li><strong>SESSIONSINGLETON</strong>: Class will be created and configured "session singleton"</li>
</ul>
<br />
<h4 id="Chapter-3-2-getAndInitServiceObject"><a href="#Chapter-3-2-getAndInitServiceObject">3.2. __getAndInitServiceObject()</a></h4>
In order to create an instance using the <strong>__getAndInitServiceObject()</strong> method, the
desired class must inherit from <strong>coreObject</strong> and implement the abstract
<strong>init()</strong> function. The <strong>init()</strong> method is designed to initialize the
class using the initialization parameter taken as an argument of <strong>init()</strong>. The
parameter can be any kind of data type. Usually strings or arrays are used. If you intend to create
an instance of the class
<gen:highlight type="php">
class myServiceLayer extends coreObject {

   var $__MySpecialParam = null;

   function myServiceLayer(){
   }

   function init($InitParam){
      $this->__MySpecialParam = $InitParam;
   }

}
</gen:highlight>
using the method <strong>__getAndInitServiceObject()</strong>, the follwing lines must be placed in
you application's code:
<gen:highlight type="php">
  $SL = &$this->__getAndInitServiceObject('service::layer::namespace','myServiceLayer','InitParamValue','{MODE}');
</gen:highlight>
<strong>InitParamValue</strong> is to be replaced with the configuration value of your choice.
<strong>{MODE}</strong> must be filled with on of the values presented in the list below:
<ul>
  <li><strong>NORMAL</strong>: Class will be created and configured "normally"</li>
  <li><strong>SINGLETON</strong>: Class will be created and configured "singleton"</li>
  <li><strong>SESSIONSINGLETON</strong>: Class will be created and configured "session singleton"</li>
</ul>
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="en_030" />