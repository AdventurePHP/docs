<doku:title parent="119" tags="form,taglib,validatoren,validator,filter,auto,ausfuellen,presetting,1.11" title="Forms" urlname="Forms">
   Das APF bietet auf Basis von Taglibs eine komplette Abstraktion von Formularen und
   Formular-Elementen. Diese beherrschen out-of-the-box Presetting (Auto-Ausfüllen), Validierung
   und Filterung. Im Document-Controller steht ein Formular als eigenständiges Objekt mit diversen
   Funktionen zur Verfügung.
</doku:title>
<h3 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction">1. Introduction</a></h3>
<p>
   Due to the fact, that the <int:link pageid="098"/> of the APF provides a generic frame to handle
   taglibs, we were able to implement a form abstraction built on taglibs (e.g. text fields).
</p>
<p>
   The release of the adventure php framework contains a set of taglibs, that fully describe HTML
   forms and that contain features such as filtering, validation and presetting at the same time out of
   the box. With the taglibs reworked with release 1.11, form fields can be applied various filters and
   validators and custom form elements can be integrated with the delivered ones.
</p>
<p>
   The subsequent chapters describe the general design and the handling of APF forms as well as the
   tags shipped with the release with their meaning and functionality. Reading this documentation
   and implementing applications, it is recommended to have the
   <a href="./?Page=002-API-documentation" title="API documentation">API documentation</a> opened.
   There, you can see, which functionality is included in the various taglibs - e.g. the
   <strong>html_taglib_form</strong>.
</p>
<div class="hint">
   Chapter <int:link pageid="114" /> contains extended examples on form usage and extension of
   APF forms.
</div>

<h3 id="Chapter-2-Construction"><a href="#Chapter-2-Construction">2. Construction of forms</a></h3>
As noted in the introduction, APF forms are represented by taglibs. The
<strong>&lt;html:form /&gt;</strong> tag forms the base taglib, that encapsulates all other form
tags and presents an APF form <em>as a single</em> object to the document controller. It contains
further tag instances as it's child oblects that represent dedicated elements like text fields or
buttons or functional tags such as place holders, listeners or tags, that add custom form controls.
<br />
<br />
Forms - as you know from other APF GUI elements - are defines within template files. A simple form
with a search field and a button looks like this:
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="tools::form::taglib" prefix="html" class="form" /&gt;
&lt;html:form name="Search"&gt;
   &lt;form:text name="searchterm" /&gt; &lt;form:button name="search" value="GO" /&gt;
&lt;/html:form&gt;
</gen:highlight>
In order to display the form a document controller must be defined for the corresponding template.
This is necessary, because a form - in contrast to other tags - is always coupled with functionality
to handle the data passed to the form. This may be reading the search term or executing the search
or saving user data.
<br />
<br />
Displaying a form is not rocket science with the APF and can be done with the following controller
code:
<gen:highlight type="php">
class search_controller extends base_controller {
   public function transformContent(){
      $form = &$this->getForm('Search');
      $form->transformOnPlace();
   }
}
</gen:highlight>
<p>
   The subsequent sections present the form controls contained within the APF release and give you
   a brief introduction to the usage of these elements.
</p>

<h3 id="Chapter-3-Shipped-tags"><a href="#Chapter-3-Shipped-tags">3. Shipped tags</a></h3>
<p>
   The APF contains an extended set of form control abstraction tags, that can be configured for
   different purposes. In case this is not enough, custom form taglibs can be introduced as desired.
   This is described in detail under
   <a href="./?Page=114-Form-usage" title="Usage of forms">usage of forms</a>.
</p>
<p>
   Since the APF's page controller is built up on a generic tag parser, form tags can be added
   generic attributes such as:
</p>
<ul>
   <li><strong>id="..."</strong></li>
   <li><strong>class="..."</strong></li>
   <li><strong>style="..."</strong></li>
</ul>
<p>
   These are presented in the generated source code and can thus be used for formatting purposes. For
   this reason, the following chapters do not mention these attributes, but only describe the
   attributes, that are necessary for the configuration of the tag.
</p>
<div class="hint">
   Another generic attribute is <em>optional</em> that is used to mark a form control as optional
   concerning the validation. Details can be taken from the
   <int:link pageid="113" anchor="Chapter-4-1-Shipped-validators">shipped validators</int:link>
   chapter.
</div>
<div class="hint">
   Attributes, that are surrounded with &quot;[&quot; and &quot;]&quot; (brackets) are optional.
   All other attributes must be present, otherwise the corresponding taglib may throw an error.
</div>
<p>The form tag itself takes three functional atributes, that are used for definition and configuration:</p>
<gen:highlight type="apf-xml">
&lt;html:form name="" [method=""] [action=""]&gt;
  ...
&lt;/html:form&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the form. This attribute is used to address the form within
    a document controller.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>method</strong>: Method that is used to send the form data. By default,
    <strong>post</strong> is used.
    (<strong>Allowed characters</strong>: <code>[get|post]</code>)
  </li>
  <li>
    <strong>action</strong>: The url, that is called on button click by the browser.
  </li>
</ul>
<div class="hint">
   As of release 1.13 the possibility was added to define a global default value for the <em>action</em>
   attribute using the registry. The value can be defines within the bootstrap file using
   <gen:highlight type="php">Registry::register('apf::tools', 'FormDefaultMethod','...')</gen:highlight>
   This causes all forms to take this value in case the attribute is not specified within the local
   declaration. If the global default value is not explicitly specified, &quot;post&quot; is taken.
</div>
<div class="hint">
   Please note, thet text fields do not support array name notation (example <em>text[de]</em>). The
   reason for this is that text fields should only include scalar values. Concerning this contract,
   the validators do only read scalar values and thus cannot handle arrays.
</div>

<h4 id="Chapter-3-1-Button"><a href="#Chapter-3-1-Button">3.1. Button</a></h4>
This taglib represents a submit button. APF form elements are validated and filtered on button click
event. Hence, it is necessary to specify a button or image button within the form, due buttons
create the <em>click event</em>.
<gen:highlight type="apf-xml">
&lt;form:button name="" value="" /&gt;

&lt;form:button name=""&gt;
   &lt;button:getstring
      [name=""]
      namespace=""
      config=""
      entry="" /&gt;
&lt;/form:button&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the button. The name is used to access the button. This is
    necessary for validators and filters.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the button. The browser uses this value to label the button.
  </li>
</ul>
<div class="hint">
   Since release 1.14 labeling the button can be done using the <em>&lt;button:getstring /&gt;</em>
   tag. Details on the configuration can be read about in the chapter, that describes the
   <int:link pageid="046" anchor="Chapter-2-2-Getstring">&lt;html:getstring /&gt;</int:link> tag.
</div>

<h4 id="Chapter-3-2-Image-button"><a href="#Chapter-3-2-Image-button">3.2. Image button</a></h4>
<p>
   The image button tag creates an image button, that uses an image as the label. The functionality
   is equal to the &quot;normal&quot; button.
</p>
<gen:highlight type="apf-xml">
&lt;form:imagebutton name="" src="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the button. The name is used to access the button. This is
    necessary for validators and filters.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>src</strong>: Image source.
  </li>
</ul>
<br />
<h4 id="Chapter-3-3-Reset"><a href="#Chapter-3-3-Reset">3.3. Reset button</a></h4>
As of the release 1.10, the form taglibs contain a reset button wrapper. It represents a HTML reset
button and can be addressed and configured as &quot;normal&quot; buttons within a document
controller.
<br />
<br />
<div class="hint">
   A reset button does not fire the click event, thus validation and filtering is not possible!
</div>
<gen:highlight type="apf-xml">
&lt;form:reset name="" value="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>value</strong>: The value (label) of the reset button.
  </li>
</ul>
<br />
<h4 id="Chapter-3-4-Hidden"><a href="#Chapter-3-4-Hidden">3.4. Hidden field</a></h4>
<gen:highlight type="apf-xml">
&lt;form:hidden name="" value="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: The name of the hidden field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: The value of the hidden field.
  </li>
</ul>
<br />
<h4 id="Chapter-3-5-Text"><a href="#Chapter-3-5-Text">3.5. Text field</a></h4>
<gen:highlight type="apf-xml">
&lt;form:text name="" [value=""] /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the text fields. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of te text field.
  </li>
</ul>
<br />
<h4 id="Chapter-3-6-Text-area"><a href="#Chapter-3-6-Text-area">3.6. Text area</a></h4>
You can use the APF text area wrapper taglib in two flavours: without explicit content as a
self-closing tag and with content as explicitly closing tag.
<gen:highlight type="apf-xml">
&lt;form:area name="" /&gt;
&lt;form:area name=""&gt;...&lt;/form:area&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the text area. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<br />
<h4 id="Chapter-3-7-Password"><a href="#Chapter-3-7-Password">3.7. Password field</a></h4>
<gen:highlight type="apf-xml">
&lt;form:password name="" [value=""]/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the password field. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the password field.
  </li>
</ul>
<br />
<h4 id="Chapter-3-8-File-upload-field"><a href="#Chapter-3-8-File-upload-field">3.8. File upload field</a></h4>
<p>
   The file upload field can be defined as follows:
</p>
<gen:highlight type="apf-xml">
&lt;form:file name="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the file upload field. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<p>
   As of release 1.12, the file upload field was enhanced to support the developer to build file
   upload forms easily. For this reason, the taglib was enhanced by the following methods that can
   be used in document controllers to handle uploaded files:
</p>
<ul>
   <li>
      <em>hasUploadedFile():boolean</em>: returns <em>true</em> in case a file has been uploaded and
      <em>false</em> otherwise.
   </li>
   <li>
      <em>getFile():FileModel</em>: returns an instance of the <em>FileModel</em> that represents an
      uploaded file. In case no file has been uploadad <em>null</em> is returned.
   </li>
</ul>
<p>
   The wiki article
   <a class="wiki" href="http://wiki.adventure-php-framework.org/de/File-Upload_mit_Form-Taglibs" title="File-Upload mit Form-Taglibs">File-Upload mit Form-Taglibs</a>
   (German) describes, how file upload can now be realized easily. Please note the
   <a href="#Chapter-4-1-12-MimeTypeValidator">MimeTypeValidator</a> and
   <a href="#Chapter-4-1-13-FileSizeValidator">FileSizeValidator</a> added in 1.12. They can be
   used to validate the files uploaded by the user.
</p>

<h4 id="Chapter-3-9-Checkbox"><a href="#Chapter-3-9-Checkbox">3.9. Checkbox</a></h4>
The checkbox implementation is not only a simple wrapper for the HTML checkbox, but includes the
functionality to automatically check or uncheck the box. With this taglib, the problem with
re-checking boxes on re-submit is solved.
<gen:highlight type="apf-xml">
&lt;form:checkbox name="" value="" [checked="checked"] /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the checkbox. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the checkbox.
  </li>
  <li>
    <strong>checked</strong>: Defines, whether the checkbox should be preselected.
  </li>
</ul>
<br />
<h4 id="Chapter-3-10-Radio-button"><a href="#Chapter-3-10-Radio-button">3.10. Radio button</a></h4>
The radio button implementation is not only a simple wrapper for the HTML radio buttons, but
includes the functionality to automatically check or uncheck the button. With this taglib, the
problem with re-checking buttons on re-submit is solved.
<gen:highlight type="apf-xml">
&lt;form:radio name="" value="" [checked="checked"]/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the radio button. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the radio button - or precisely - the name of the current option.
  </li>
  <li>
    <strong>checked</strong>: Defines, whether the button should be preselected.
  </li>
</ul>

<h4 id="Chapter-3-11-Select"><a href="#Chapter-3-11-Select">3.11. Select field</a></h4>
<p>
   A select field can be defined using multiple approaches: using static or dynamic options and/or
   group or a combination of both ways. Dynamic options and groups can be added or processed using a
   <int:link pageid="006" />.
</p>
<p>
   Since release 1.12 option groups are fully supported by the APF's form taglibs.
</p>
<gen:highlight type="apf-xml">
&lt;form:select name="" /&gt;

&lt;form:select name=""&gt;
  &lt;select:option value="" [selected="selected"]&gt;...&lt;/select:option&gt;
  [&lt;select:group label=""&gt;
     &lt;group:option value="" [selected="selected"]&gt;...&lt;/group:option&gt;
  &lt;select:group&gt;]
&lt;/form:select&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the select field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the option.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>selected</strong>: In case an option should be preselected, the <em>selected</em>
    attribute must contain the name of the attribute as it's value.
  </li>
  <li>
    <strong>label</strong>: Defines the label of the option group.
  </li>
</ul>

<h4 id="Chapter-3-12-Multi-select"><a href="#Chapter-3-12-Multi-select">3.12. Multi select field</a></h4>
<p>
   As the simple select field, the multi select field allows you to specify two different types: with
   and without static options.
</p>
<gen:highlight type="apf-xml">
&lt;form:multiselect name="" /&gt;

&lt;form:multiselect name=""&gt;
  &lt;select:option value="" [selected="selected"]&gt;&lt;/select:option&gt;
  [&lt;select:group label=""&gt;
     &lt;group:option value="" [selected="selected"]&gt;...&lt;/group:option&gt;
  &lt;select:group&gt;]
&lt;/form:multiselect&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the multi select field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the option.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>selected</strong>: In case an option should be preselected, the <em>selected</em>
    attribute must contain the name of the attribute as it's value.
  </li>
  <li>
    <strong>label</strong>: Defines the label of the option group.
  </li>
</ul>
<div class="hint">
   The name of the form field must not contain &quot;[]&quot; at the end. Otherwise errors occure
   when addressing the element!
</div>

<h4 id="Chapter-3-13-Place-holder"><a href="#Chapter-3-13-Place-holder">3.13. Place holder</a></h4>
A place holder can be used to insert dynamic content into the form.
<gen:highlight type="apf-xml">
&lt;form:placeholder name="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the place holder. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
Filling a place holder, the <strong>html_taglib_form</strong>'s method
<strong>setPlaceHolder()</strong> can be uses:
<gen:highlight type="php">
$form = &$this->getForm('MyForm');
$form->setPlaceHolder('NameOfThePlaceHolder','...Value...');
</gen:highlight>
<br />
<h4 id="Chapter-3-14-Date-control"><a href="#Chapter-3-14-Date-control">3.14. Date control</a></h4>
To ease date select field generation, the APF contains a date form control that can be configured
to fit your needs.
<gen:highlight type="apf-xml">
&lt;form:date name="" [yearrange=""] [offsetnames=""]/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the date control. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>yearrange</strong>: The range of years, that should be presented to the user.
    Example: <code>1990-2007</code>.
    (<strong>Allowed characters</strong>: <code>[0-9-]</code>)
  </li>
  <li>
    <strong>offsetnames</strong>: Explicitly specifies the name of the date control's components
    (=name of the single fields). Example: <code>day;month;year</code>.
    (<strong>Allowed characters</strong>: <code>[A-Za-z;]</code>)
  </li>
</ul>
<br />
<h4 id="Chapter-3-15-Marker"><a href="#Chapter-3-15-Marker">3.15. Marker</a></h4>
As described in chapter
<a href="" title="Dynamic forms">dynamic forms</a>,
the <strong>&lt;form:marker /&gt;</strong> tag can be used to position dynamic form elements. The
tag itself creates no output.
<gen:highlight type="apf-xml">
&lt;form:marker name="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the markers. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
</ul>
<br />
<h4 id="Chapter-3-16-Addtaglib"><a href="#Chapter-3-16-Addtaglib">3.16. Addtaglib</a></h4>
The <strong>&lt;form:addtaglib /&gt;</strong> tag is the pendant to the
<strong>&lt;core:addtaglib /&gt;</strong> tag. It offers the possibbility to add custom form tags.
<gen:highlight type="apf-xml">
&lt;form:addtaglib namespace="" prefix="" class="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path seperated with "::".
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML prefix
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML class
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
</ul>
<div class="hint">
   Please note, that the taglibs added with this tag implement the <strong>form_control</strong>
   class to ensure, that the correct status is reported to the form by isSent() and isValid().
</div>
<br />
<h4 id="Chapter-3-17-Getstring"><a href="#Chapter-3-17-Getstring">3.17. Getstring</a></h4>
The <strong>&lt;form:getstring /&gt;</strong> tag offers the possibility to display language
dependent values from a language dependent config file within forms. Details on the configuration
can be read about in the chapter, that describes the
<int:link pageid="046" anchor="Chapter-2-2-Getstring">&lt;html:getstring /&gt;</int:link>
tag.
<gen:highlight type="apf-xml">
&lt;form:getstring [name=""] namespace="" config="" entry="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
   <li>
      <strong>name</strong>: Name of the place holder as identifier for the <em>getLabel()</em> method
      (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
   </li>
  <li>
    <strong>namespace</strong>: Namespace of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name of the configuration key to display the value of.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>

<h4 id="Chapter-3-18-Listener"><a href="#Chapter-3-18-Listener">3.18. Listener</a></h4>
The listener tag is part of the new validation concept. The tag &quot;listens&quot; on the event, the
validator fires and shows it's content, in case the addressed form element could not be validated
successfully. Within the body of the tag, several subtags and textual content can be defined, that
can be used to format the output. Details on the validation concept can be read about in chapter 4.
<gen:highlight type="apf-xml">
&lt;form:listener [name=""] control="..." [validator="..." ]&gt;
  ...
  [&lt;listener:getstring namespace="" config="" entry="" /&gt;]
  [&lt;listener:placeholder name="" /&gt;]
  [&lt;listener:addtaglib namespace="" prefix="" class=""/&gt;]
  ...
&lt;/form:listener&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>control</strong>: Name of the form element, that the validator tag listens to.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
  <li>
    <strong>name</strong>: Name of the listener. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
  <li>
     <strong>validator</strong>: Name of the validator, that is allowed to notify the listener on
     validation errors.
  </li>
</ul>
<p>
   The place holder tag <em>&lt;listener:placeholder /&gt;</em> acts like the
   <int:link pageid="046" anchor="Chapter-2-1-Placeholder">&lt;html:placeholder /&gt;</int:link>,
   the <em>&lt;listener:getstring /&gt;</em> tag like the
   <int:link pageid="046" anchor="Chapter-2-2-Getstring">&lt;html:getstring /&gt;</int:link>
   tag, and the <em>&lt;listener:addtaglib /&gt;</em> tag like the
   <int:link pageid="046" anchor="Chapter-1-1-Addtaglib">&lt;core:addtaglib /&gt;</int:link> tag.
</p>
<p>
   In order to fill the the place holder, the following document controller code can be used:
</p>
<em>Template:</em>
<gen:highlight type="apf-xml">
&lt;html:form name="name_form" method="post"&gt;
   &lt;form:listener name="name-listener" control="name"&gt;
      Please fill in the &lt;listener:placeholder name="field-name" /&gt; field!
   &lt;/form:listener&gt;
   &lt;form:text name="name" /&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      control="name"
      button="send"
   /&gt;
   &lt;form:button name="send" value="Send" /&gt;
&lt;/html:form&gt;
</gen:highlight>
<em>Controller:</em>
<gen:highlight type="php">
class form_controller extends base_controller {
   public function transformContent(){
      $form = &$this->getForm('name-form');
      $listener = &$form->getFormElementByName('name-listener');
      $listener->setPlaceHolder('field-name','name');
   }
}
</gen:highlight>
<p>
   The attribute <em>validator</em> can be used in case the form control to validate has a
   <a href="#">special validator</a> defined. One sample application case is an email field, that
   should be marked up with two different error messages: one for missing input and one for
   incorrect email addresses. To achieve this, you can use the following template code:
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="email_form" method="post"&gt;
   &lt;form:listener control="email" validator="TextLengthValidator"&gt;
      Please fill in the email field!
   &lt;/form:listener&gt;
   &lt;form:listener control="email" validator="EMailValidator"&gt;
      Please fill in the email field with a correct email address!
   &lt;/form:listener&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      control="name"
      button="send"
      type="special"
   /&gt;
   &lt;form:addvalidator
      class="EMailValidator"
      control="email"
      button="send"
      type="special"
   /&gt;
   &lt;form:button name="send" value="Send" /&gt;
&lt;/html:form&gt;
</gen:highlight>
<div class="warn">
   Please note, that validators having the attribut <em>type</em> set to <em>special</em> do only
   notify special validators. In case the validator messages of the target control should be marked,
   you can add another <em>EMailValidator</em>, that notifies listeners, that contain the necessary
   markup.:
<gen:highlight type="apf-xml">
&lt;html:form name="email_form" method="post"&gt;
   &lt;form:listener control="email"&gt;
      &lt;div class="error-container"&gt;
   &lt;/form:listener&gt;
   &lt;form:listener control="email" validator="TextLengthValidator"&gt;
      Please fill in the email field!
   &lt;/form:listener&gt;
   &lt;form:listener control="email" validator="EMailValidator"&gt;
      Please fill in the email field with a correct email address!
   &lt;/form:listener&gt;
   &lt;form:listener control="email"&gt;
      &lt;/div&gt;
   &lt;/form:listener&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      control="name"
      button="send"
      type="special"
   /&gt;
   &lt;form:addvalidator
      class="EMailValidator"
      control="email"
      button="send"
      type="special"
   /&gt;
   &lt;form:addvalidator
      class="EMailValidator"
      control="email"
      button="send"
   /&gt;
   &lt;form:button name="send" value="Send" /&gt;
&lt;/html:form&gt;
</gen:highlight>
</div>

<h4 id="Chapter-3-19-Error"><a href="#Chapter-3-19-Error">3.19. Display of form errors</a></h4>
The tag described within chapter 3.18 can be used to automatically display field relevant errors.
The <nobr><strong>&lt;form:error /&gt;</strong></nobr> tag is used to display errors for the matter
of the whole form. If one of the fields could not be validated successfully, the content of the tag
is displayed - if present in the form definition.
<gen:highlight type="apf-xml">
&lt;form:error [name=""]&gt;
  ...
  [&lt;error:getstring namespace="" config="" entry="" /&gt;]
  [&lt;error:placeholder name="" /&gt;]
  [&lt;error:addtaglib namespace="" prefix="" class="" /&gt;]
  ...
&lt;/form:error&gt;
</gen:highlight>
<p>
   The place holder tag <strong>&lt;error:placeholder /&gt;</strong> acts like the
   <int:link pageid="046" anchor="Chapter-2-1-Placeholder">&lt;html:placeholder /&gt;</int:link>,
   the <strong>&lt;error:getstring /&gt;</strong> tag like the
   <int:link pageid="046" anchor="Chapter-2-2-Getstring">&lt;html:getstring /&gt;</int:link>
   tag, and the <em>&lt;error:addtaglib /&gt;</em> tag like the
   <int:link pageid="046" anchor="Chapter-1-1-Addtaglib">&lt;core:addtaglib /&gt;</int:link> tag.
   Filling the place holder can be done as described in the last chapter.
</p>

<h4 id="Chapter-3-20-Success"><a href="#Chapter-3-20-Success">3.20. Display of form success messages</a></h4>
The tag described within chapter 3.19 can be used to automatically display error messages for the
matter of the whole form. Often, it is necessary to display messages in case the form was correctly
filled. The <nobr><strong>&lt;form:success /&gt;</strong></nobr> displays it's content, in case all
fields are maked valid. The definition of the tag is as follows:
<gen:highlight type="apf-xml">
&lt;form:success [name=""]&gt;
  ...
  [&lt;success:getstring namespace="" config="" entry="" /&gt;]
  [&lt;success:placeholder name="" /&gt;]
  [&lt;success:addtaglib namespace="" prefix="" class="" /&gt;]
  ...
&lt;/form:success&gt;
</gen:highlight>
<p>
   The place holder tag <strong>&lt;success:placeholder /&gt;</strong> acts like the
   <int:link pageid="046" anchor="Chapter-2-1-Placeholder">&lt;html:placeholder /&gt;</int:link>,
   the <strong>&lt;success:getstring /&gt;</strong> tag like the
   <int:link pageid="046" anchor="Chapter-2-2-Getstring">&lt;html:getstring /&gt;</int:link>
   tag, and the <em>&lt;success:addtaglib /&gt;</em> tag like the
   <int:link pageid="046" anchor="Chapter-1-1-Addtaglib">&lt;core:addtaglib /&gt;</int:link> tag.
   Filling the place holder can be done as described in the last chapter.
</p>

<h5 id="Chapter-3-21-TimeCaptcha"><a href="#Chapter-3-21-TimeCaptcha">3.21. TimeCaptcha</a></h5>
<p>
   The <strong>TimeCaptcha</strong> can be used in combination with the
   <a href="#Chapter-4-1-16-TimeCaptchaValidator">TimeCaptchaValidator</a> to defeat (spam-)bots
   in forms. For this reason, the taglib saves the point in time, the form is generated and makes
   this timestamp available for the validator within the session.
</p>
<p>
   Setting the optional attribute <em>seconds</em> the minimal time can be influenced that the
   validator uses to decide, whether the form was filled by a bot or a regular user. The value of the
   attribute must contain an integer value of the desired period of time.
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   <form:timecaptcha name="timecaptcha" [seconds="3"]/>
   ...
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-3-22-CSRF-protection"><a href="#Chapter-3-22-CSRF-protection">3.22. CSRF protection</a></h5>
<p>
   This taglib creates a hidden field that contains a generated hash key. In case the hash sent
   with the form differs from the calculated hash, the form is marked invalid. Doing so, the form
   can be protected from CSRF attacks.
</p>
<div class="hint">
   The <em>CSRFHashValidator</em> shipped with the APF release must not be added manually within
   the form definition. This is done within the taglib automatically for you.
</div>
<p>
   Hash generation is delegated to the configured component concerning the provider pattern. This
   makes it easy to change the algorithm. To customize the hash key generation, the 
   <em>CSRFHashProvider</em> interface must be implemented that requires the <em>generateHash()</em>
   to be implemented.
</p>
<p>
   The subsequent code box shows the provider that is already included in the APF:
</p>
<gen:highlight type="php">
class EncryptedSIDHashProvider extends APFObject implements CSRFHashProvider {
   public function generateHash($salt) {
      if(!defined('SID')) {
         session_start();
      }

      return md5($salt.SID);
   }
}
</gen:highlight>
<p>
   The provider to use can be specified with the <em>namespace</em> and <em>class</em> attributes.
   In case the attributes are not present the default provider is used. The <em>EncryptedSIDHashProvider</em>
   creates an MD5 hash concatenating the session id and the configured salt.
</p>
<gen:highlight type="apf-xml">
&lt;form:csrfhash
   salt=""
   name=""
   [namespace=""
   class=""]
/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>salt</strong>: The salt that is used to calculate a more secure hash.
  </li>
  <li>
     <strong>name</strong>: The name of the control. (<strong>Allowed characters</strong>: [A-Za-z0-9_]).
  </li>
  <li>
     <strong>namespace</strong>: The namespace of the hash provider.
  </li>
  <li>
     <strong>class</strong>: The class name of the hash provider.
  </li>
</ul>

<h5 id="Chapter-3-23-Time-control"><a href="#Chapter-3-23-Time-control">3.23. Time control</a></h5>
<p>
   To ease creation of time selection controls the APF provides the time control. This form control
   can be configured as desired using the following attributes:
</p>
<gen:highlight type="apf-xml">
&lt;form:time
   name=""
   [hoursrange=""]
   [offsetnames=""]
   [showseconds="true|false"]
   [minutesinterval=""]
/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: The name of the time control that can be used to access it.
    (<strong>Allowed characters</strong>: [A-Za-z0-9-_])
  </li>
  <li>
     <strong>hoursrange</strong>: Range of the hour field. Example: <em>08-21</em>.
     (<strong>Allowed characters</strong>: [0-9-])
  </li>
  <li>
     <strong>offsetnames</strong>: Names of the fields for hour, minute, and second. The field names
     must be separated by ";". Example: <em>Hour;Minute;Second</em>.
     (<strong>Allowed characters</strong>: [A-Za-z;])
  </li>
  <li>
     <strong>showseconds</strong>: Using this attribute, you can configure, whether a select box
     for seconds should be displayed.
  </li>
  <li>
     <strong>minutesinterval</strong>: With this attribute you can define the interval of the minutes
     displayed in the minutes select box. Please note, that you should take care that the number provided
     within this attribute is a suitable divisor of 60. Example: 5, 10, or 15.
  </li>
</ul>

<h3 id="Chapter-4-Validation"><a href="#Chapter-4-Validation">4. Validation</a></h3>
<p>
   In the previous versions of the APF the validation was linked directly with a form element and
   the validation was executed within the <int:link pageid="098" anchor="Chapter-2-1-Activity-diagram">lifecycle of the taglibs</int:link>.
   This has the disadvantage, that one element can be defined with only one validator. This leads to
   redundant code, because each field must have it's own validator defined. Furthermore, it was not
   possible to implement own validators.
</p>
<p>
   From version 1.11 these circumstances were considered and the form taglibs were moved to a new
   variation of the validation. From this version validators are applied by an own tag, that follows
   the <a class="external" href="http://en.wikipedia.org/wiki/Observer_pattern" title="Observer pattern">observer pattern</a>.
   The tag itself then binds a validator to the desired form control. Thus it is possible to attach
   several validators onto one field, to write own validators and to validate several fields with one
   observer definition at the same time.
</p>
<p>The definition of a validator now is as follows:</p>
<gen:highlight type="apf-xml">
&lt;form:addvalidator
   namespace=""
   class=""
   button=""
   control=""
   [type="special"]
/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the validator implementation.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>class</strong>: Name of the validator implementation (name = class name!)
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>button</strong>: Name of the button, that triggers the validation event. The validation
    is executed, when the <em>isSent</em> event is fired by a button or an image button.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>control</strong>: Name of the form control to validate. In case, multiple controls should
    be allocated the same validator by only one tag definition, the attribute can contain a
    pipe-separated list of form controls (e.g. <em>sender|recipient|subject</em>).
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_|]</code>)
  </li>
  <li>
     <strong>type</strong>: In case the optional attribute is set to <em>special</em> only listeners
     are notified, that contain the name (=class name) of the validator in the <em>validator</em>
     attribute.
     (<strong>Allowed characters</strong>: <code>special</code>)
  </li>
</ul>
<div class="hint">
   In case you are using shipped validators, the <strong>namespace</strong> attribute can be omitted.
   The taglib therefore uses <strong>tools::form::validator</strong> as the default value. Within
   this namespace, all validators described in chapter 4.1 are located there.
</div>
<div class="hint">
   Notes on special validator listeners can be read about in the wiki article
   <a class="wiki" href="http://wiki.adventure-php-framework.org/de/Spezielle_Validator-Listener" title="Spezielle Validator-Listener">Spezielle Validator-Listener</a>
   (German).
</div>
<p>
   Within release 1.12 the marking of invalid form controls has been switched to css classes. This
   eases formatting and is much more flexible. The implementation proposal can be read about on the
   <a class="wiki" href="http://wiki.adventure-php-framework.org/de/Weiterentwicklung_Formular-Validierung" title="Weiterentwicklung Formular-Validierung">Weiterentwicklung Formular-Validierung</a>
   (German) page.
</p>
<p>
   By default, those form controls that are marked invalid by validators are added the
   <em>apf-form-error</em> css class. In case you want to use your own css class just add the
   <em>valmarkerclass</em> attribute for the appropriate form control:
</p>
<gen:highlight type="apf-xml">
<form:text
   name="age"
   valmarkerclass="special-val-marker"
/>
</gen:highlight>
<p>
   In order to optically mark all invalid form controls within your web project having a red border
   add the subsequent style definition to yout css files:
</p>
<gen:highlight type="css">
.apf-form-error {
   border: 2px solid red;
}
</gen:highlight>
<p>
   Please note, that special css marker class must be contained in your css definition, too. Otherwise,
   an invalid field may not be marked optically.
</p>

<h4 id="Chapter-4-1-Shipped-validators"><a href="#Chapter-4-1-Shipped-validators">4.1. Shipped validators</a></h4>
<p>
   As in previous releases, the APF shipps a couple of built-in validators. These usually cover the
   large part of the demands. Should these not be enough, own validators can be implemented. This is
   described in the next chapter.
</p>
<div class="hint">
   Since release 1.13 validators can be decladed optional. Therefore, the appropriate form control
   must have the <em>optional</em> attribute set to <em>true</em>:
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="age" optional="true"/&gt;
   &lt;form:addvalidator
      class="IntegerValidator"
      button="send"
      control="age"
   /&gt;
   &lt;form:button name="send" value="Send" /&gt;
&lt;/html:form&gt;
</gen:highlight>
   Please note, that optional validation is only available for textual fields at the moment. The
   APF developers agreed that optional validation of select and checkbox fields does make no sense.
</div>
<p>Currently the following validators are available:</p>

<h5 id="Chapter-4-1-1-TextLengthValidator"><a href="#Chapter-4-1-1-TextLengthValidator">4.1.1. TextLengthValidator</a></h5>
<p>
   The <strong>TextLengthValidator</strong> checks a text form field (text field, password field,
   text area) whether the contained text has a least length. By default, the text entered by the user
   must have a least length of 3 characters, before the field is considered valid. Provided that
   another text length is desired, the attributes <strong>minlength</strong> and
   <strong>maxlength</strong> must be given in the attribute list of the referenced text field:
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="firstname" /&gt;
   &lt;form:text name="lastname" minlength="5" /&gt;
   &lt;form:password name="pass" /&gt;
   &lt;form:area name="comment" minlength="20" maxlength="200"/&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      button="send"
      control="firstname|lastname|pass|comment"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<p>
   Within the code block the form control <strong>firstname</strong> is tested to contain at least >=3
   characters, the <strong>lastname</strong> field must contain at least 5 characters and at maximum
   200 characters to be considered valid.
</p>
<p>
   Since release 1.12 it is possible to enable strict validation of the text length. To do so, you
   can add the <strong>mode</strong> attribute to the target control. In case it is filled with
   <em>strict</em> the input is filtered through <em>trim()</em> to accept content that does not
   only contain blanks.
</p>

<h5 id="Chapter-4-1-2-NumberValidator"><a href="#Chapter-4-1-2-NumberValidator">4.1.2. NumberValidator</a></h5>
The <strong>NumberValidator</strong> checks whether a text field contains a valid number. For this reason,
the PHP function <em>is_numeric()</em> is used.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="number" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="NumberValidator"
      button="send"
      control="number"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-3-EMailValidator"><a href="#Chapter-4-1-3-EMailValidator">4.1.3. EMailValidator</a></h5>
The <strong>EMailValidator</strong> checks whether the referenced form control contains a valid
email address. For this reason, the content of the text field is checked against a regular expression.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="EMailValidator"
      button="send"
      control="email"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-4-PhoneAndFaxValidator"><a href="#Chapter-4-1-4-PhoneAndFaxValidator">4.1.4. PhoneAndFaxValidator</a></h5>
The <strong>PhoneAndFaxValidator</strong> checks whether a form field contains a valid phone or
fax number. For this reason, the content of the text field is checked against a regular expression.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="phone" /&gt;
   &lt;form:text name="fax" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="PhoneAndFaxValidator"
      button="send"
      control="phone|fax"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-5-FieldCompareValidator"><a href="#Chapter-4-1-5-FieldCompareValidator">4.1.5. FieldCompareValidator</a></h5>
With the <strong>FieldCompareValidator</strong> you are enabled to compare the content of two text
fields. If the content of both controls is equal, the fields ara makred valid.
<br />
<br />
Due to the fact, that an APF form validator must be added to one dedicated control (due to observer
implementation), the main control must define the reference on the control, that can be used to
double check the content. For this reason, the <strong>ref</strong> attribute within the main
control definition must refer to the field, that is defined for the comparison check.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:password name="pass" ref="pass2" /&gt;
   &lt;form:password name="pass2" /&gt;
   &lt;form:addvalidator
      class="FieldCompareValidator"
      control="pass"
      button="login"
   /&gt;
   &lt;form:button name="login" value="login" /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-6-SimpleBirthdayValidator"><a href="#Chapter-4-1-6-SimpleBirthdayValidator">4.1.6. SimpleBirthdayValidator</a></h5>
The <strong>SimpleBirthdayValidator</strong> is also belonging to the group of text field validators
and checks the content of a text field to contain a date definition that matches the pattern
<strong>dd.MM.YYYY</strong>.
<div class="hint">
   This validator can only be used with &quot;normal&quot; text fields. In case you intend to
   validate a date control, the
   <a href="#Chapter-4-1-12-SimpleDateControlValidator" title="4.1.12. SimpleDateControlValidator">SimpleDateControlValidator</a>
   must be used or you must implement a custom validator as desired.
</div>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="birthday" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleBirthdayValidator"
      button="send"
      control="birthday"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-7-DefaultSelectFieldValidator"><a href="#Chapter-4-1-7-DefaultSelectFieldValidator">4.1.7. DefaultSelectFieldValidator</a></h5>
<div class="warn">
   The <strong>DefaultSelectFieldValidator</strong>was removed in Release 1.13. Please use the 
   <a href="#Chapter-4-1-8-SimpleSelectControlValidator">SimpleSelectControlValidator</a> instead.
   This validator can be used for statically and dynamically filled select fields.
</div>

<h5 id="Chapter-4-1-8-SimpleSelectControlValidator"><a href="#Chapter-4-1-8-SimpleSelectControlValidator">4.1.8. SimpleSelectControlValidator</a></h5>
The <strong>SimpleSelectControlValidator</strong> validates static and dynamic text fields (=options
are filled within a document controller). The validator checks, if the selected content is not
empty.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:select name="color"&gt;
      &lt;select:option value=""&gt;&lt;/select:option&gt;
      &lt;select:option value="red"&gt;Red color&lt;/select:option&gt;
      &lt;select:option value="green"&gt;Green color&lt;/select:option&gt;
   &lt;/form:select&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleSelectControlValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-9-MultiSelectFieldValidator"><a href="#Chapter-4-1-9-MultiSelectFieldValidator">4.1.9. MultiSelectFieldValidator</a></h5>
The <strong>MultiSelectFieldValidator</strong> is the pendant to the
<strong>SimpleSelectControlValidator</strong> but validates multi select fields. It checks the
target element to have at least one option selected.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:multiselect name="colors"&gt;
      &lt;select:option value="red"&gt;Red color&lt;/select:option&gt;
      &lt;select:option value="green"&gt;Green color&lt;/select:option&gt;
   &lt;/form:multiselect&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="MultiSelectFieldValidator"
      button="send"
      control="colors"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-10-SimpleRadioControlValidator"><a href="#Chapter-4-1-10-SimpleRadioControlValidator">4.1.10. SimpleRadioControlValidator</a></h5>
Using the <strong>SimpleRadioControlValidator</strong>, a radio button as well as a radio button
group can be checked. The validator thus expects, that at one button out of a group is selected. The
validator can be used for static and dynamic form definitions.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:radio id="red" name="color" /&gt; Red color
   &lt;form:radio id="green" name="color" /&gt; Green color
   &lt;form:radio id="blue" name="color" /&gt; Blue color
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleRadioControlValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-11-SimpleDateControlValidator"><a href="#Chapter-4-1-11-SimpleDateControlValidator">4.1.11. SimpleDateControlValidator</a></h5>
The <strong>SimpleDateControlValidator</strong> validates the date control described in chapter
3.14. It requires the date to be greater or equal to today's date..
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:date name="birthday" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleDateControlValidator"
      button="send"
      control="birthday"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-12-MimeTypeValidator"><a href="#Chapter-4-1-12-MimeTypeValidator">4.1.12. MimeTypeValidator</a></h5>
<p>
   The <strong>MimeTypeValidator</strong> checks, whether the MIME type of the uploaded file can be
   found in the list of accepted file types. This list must be defines within a pipe-separated list
   in the <em>accepts</em> attribute of the form control to validate.
</p>
<p>
   The evaluation of the file type is done using the <em>finfo</em> <strong>starting at PHP 5.3</strong>.
   For older versions, the <em>type</em> offset of the <em>$_FILES</em> is used (please refer to
   <a class="external" href="http://de.php.net/manual/en/reserved.variables.files.php" title="$_FILES">$_FILES</a>
   in the PHP manual).
</p>
<div class="warn">
   The differences in evaluating the file type of the uploaded file are relevant for the definition
   of the list of allowed media types. As of PHP 5.3, the accepted file types can be defined using
   the MIME type notation (e.g. <em>application/pdf</em>) in previous versions only the file 
   extension can be added (e.g. <em>pdf</em>).
</div>
<p>
   The subsequently defined form accepts only PDF files in the upload field. The form is makred as
   invalid as long as the uploaded file matches the accepted file format:
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="upload" method="post"&gt;
   <fieldset>
      <label for="pdf">PDF file:</label>
      <form:file name="pdf" id="pdf" accepts="pdf|application/pdf" />
      <form:addvalidator
         class="MimeTypeValidator"
         control="pdf"
         button="send"
      />
      <form:button name="send" value="GO" />
   </fieldset>
&lt;/html:form&gt;
</gen:highlight>
<p>
   For compatibility reasons, the <em>accepts</em> attribute contains both the MIME type notation
   and the file extension. This makes an upgrade to PHP 5.3 more easy, because the functionality is
   still given after an upgrade.
</p>

<h5 id="Chapter-4-1-13-FileSizeValidator"><a href="#Chapter-4-1-13-FileSizeValidator">4.1.13. FileSizeValidator</a></h5>
<p>
   The <strong>FileSizeValidator</strong> checks the file size of the uploaded file. For this reason,
   the optional attributes <em>minsize</em> And <em>maxsize</em> can be used to define the allowed
   file size in <strong>in bytes</strong>.
</p>
<p>
   In case the attribute <em>minsize</em> is not defined in the target control's attribute list,
   <em>0</em> is taken as defaukt value. This let's the form accept 0 byte files as valid files. In
   case the <em>maxsize</em> attribute is not defined in the target control's attribute list, a 
   maximum size of <em>1024000</em> (=1 MB) is assumed.
</p>
<p>
   The following upload field only allows files with at least <em>20kB</em> and a maximum size of
   <em>500kB</em>:
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="upload" method="post"&gt;
   <fieldset>
      <label for="image">Image:</label>
      <form:file name="image" id="image" minsize="20480" maxsize="512000" />
      <form:addvalidator
         class="FileSizeValidator"
         control="image"
         button="send"
      />
      <form:button name="send" value="GO" />
   </fieldset>
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-14-CheckboxValidator"><a href="#Chapter-4-1-14-CheckboxValidator">4.1.14. CheckboxValidator</a></h5>
<p>
   The <strong>CheckboxValidator</strong> validates if a checkbox is activated of not. In case it is
   not activated, the control is marked as invalid.
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="upload" method="post"&gt;
   <fieldset>
      ...
      <form:checkbox name="agb" value="agb" /> Accepting terms of conditions.
      <form:addvalidator
         class="CheckboxValidator"
         button="send"
         control="agb"
      />
      <form:button name="send" value="GO" />
   </fieldset>
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-15-TimeCaptchaValidator"><a href="#Chapter-4-1-15-TimeCaptchaValidator">4.1.15. TimeCaptchaValidator</a></h5>
<p>
   The <strong>TimeCaptchaValidator</strong> can be used in combination with the
   <a href="#Chapter-3-21-TimeCaptcha">&lt;form:timecaptcha /&gt;</a> taglib to defeat (spam-)bots
   in forms. The validator checks the time, which the "user" took to complete the form. Bots
   normally only need a fraction of a second, so it should be enough to refuse all data which was
   filled within the default 2 seconds. This period can be influenced by adding an optional 
   <em>seconds</em> attribute in the taglib definition.
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   <form:timecaptcha name="timecaptcha"/>
   <form:addvalidator
      class="TimeCaptchaValidator"
      button="send"
      control="timecaptcha"
   />
   <form:button name="send" value="Send"/>
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-4-1-16-IntegerValidator"><a href="#Chapter-4-1-16-IntegerValidator">4.1.16. IntegerValidator</a></h5>
<p>
   The <em>IntegerValidator</em> validates whether the value entered is a valid interger number:
</p>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="age" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="IntegerValidator"
      button="send"
      control="age"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h4 id="Chapter-4-2-Construction-of-validators"><a href="#Chapter-4-2-Construction-of-validators">4.2. Construction of validators</a></h4>
Validators are classes, that are derived from <strong>AbstractFormValidator</strong>. This abstract
base class defines the structure of all form validators. This is necessary to be able to apply all
validators to form controls as an observer.
<br />
<br />
The interface is as follows:
<gen:highlight type="php">
abstract class AbstractFormValidator extends APFObject {

   protected $__Control;
   protected $__Button;

   public function AbstractFormValidator(form_control &$control,form_control &$button){
      $this->__Control = &$control;
      $this->__Button = &$button;
   }

   public abstract function validate($input);

   public abstract function notify();

   public function isActive(){
      return $this->__Button->isSent();
   }

}
</gen:highlight>
The constructor takes the control to validate and the button that triggers the element as arguments.
The <strong>validate()</strong> method is applied the content to check against the logic the
validator includes. The return param is expected to be of type boolean indicating successful
validation (<em>true</em>) of failure (<em>false</em>).
<br />
<br />
The method <strong>notify()</strong> is called, when a form control could not be validated
successfully. It is intended to add css formatting to the desired form control, to fill place holders
or to apply changes to the DOM tree. In common, within this function the form fields are maked as
invalid using css style definitions and the listeners are notified.
<br />
<br />
The class members <strong>$__Control</strong> and <strong>$__Button</strong> contain the instance
of the form control to validate and the button, that is used as a trigger for the validation event.
Thus, these can easily be used within the validation code.
<br />
<br />
To be able to add a validator as an observer to a form control, the form control, must support this
operation. For this reason, each form element must implement the <strong>addValidator()</strong>
function. The signature of this method is defined within <strong>form_control</strong>:
<gen:highlight type="php">
public function addValidator(AbstractFormValidator &$validator){
   if($validator->isActive()){
      if(!$validator->validate($this->getAttribute('value'))){
         $validator->notify();
      }
   }
}
</gen:highlight>
As the code snippet describes, the method takes an instance of the validator as an argument. In case,
the validator is active (=button is clicked) the validator is executed and on failure, the
<strong>notify()</strong> methode is called.
<br />
<br />
Further, the validator <em>by default</em> is passed the <strong>value</strong> of the tag, what is
only legal for text fields. Thus, non-text fields re-implement the method to pass the right content
to the validator.
<br />
<br />
<br />
<h4 id="Chapter-4-3-Implementation-of-validators"><a href="#Chapter-4-3-Implementation-of-validators">4.3. Implementation of validators</a></h4>
As mentioned in the last chapters, a validator must inherit from the
<strong>AbstractFormValidator</strong> class. Besides, the APF includes two more base classes, that
can be used to implement text field or select box validators:
<ul>
   <li><strong>TextFieldValidator:</strong> Base class for all text field validators</li>
   <li><strong>SelectFieldValidator:</strong> Base class for all select box validators</li>
</ul>
These include the functionality to mark the desired form elements as invalid and notify the
validation event listeners.
<br />
<br />
In order to implement custom validators, please remember the following topics:
<ul>
   <li>Each validator must inherit from the <strong>AbstractFormValidator</strong> class.</li>
   <li>
      The method <strong>markAsInvalid()</strong> can be used to mark a form element as invalid.
   </li>
   <li>
      Using the <strong>notifyValidationListeners()</strong> method, listeners of the applied
      form control can be notified.
   </li>
   <li>
      Using the button's <strong>isSent()</strong> method, you can decide, whether the form was
      sent or not.
   </li>
</ul>
<br />
<h3 id="Chapter-5-Filters"><a href="#Chapter-5-Filters">5. Filters</a></h3>
In the previous versions of the APF the filters were linked directly with a form element and
executed within the <int:link pageid="098" anchor="Chapter-2-1-Activity-diagram">lifecycle of the taglibs</int:link>.
This has the disadvantage, that one element can be defined with only one filter. This leads to
redundant code, because each field must have it's own filter defined.
<br />
<br />
From version 1.11 these circumstances were considered and the form taglibs were moved to a new
variation of the filter facility. Thus, filters can be added as observers just like form validators
can be defined.
<br />
<br />
<div class="hint">
   Filtering of form elements is executed <strong>before</strong> validation to avoid positive
   validation due to removed characters during filtering. This is especially relevant for the
   <strong>TextLengthValidator</strong>.
</div>
<br />
The definition of a filter now is as follows:
<gen:highlight type="apf-xml">
&lt;form:addfilter
   namespace=""
   class=""
   button=""
   control=""
/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the tilter implementation.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>class</strong>: Name of the tilter implementation (name = class name!)
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>button</strong>: Name of the button, that triggers the filter event. Filtering is
    executed, when the <em>isSent</em> event is fired by a button or an image button.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>control</strong>: Name of the form control to filter. In case, multiple controls
    should be allocated the same filter by only one tag definition, the attribute can contain a
    pipe-separated list of form controls (e.g. <em>sender|recipient|subject</em>).
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_|]</code>)
  </li>
</ul>
<div class="hint">
   In case you are using shipped validators, the <strong>namespace</strong> attribute can be omitted.
   The taglib therefore uses <strong>tools::form::filter</strong> as the default value. Within this
   namespace, all validators described in chapter 5.1 are located there.
</div>
<div class="warn">
   Please note that filtering only applies to the values within the form controls. All values within the superglobals
   <em>$_GET</em>, <em>$_POST</em>, And <em>$_REQUEST</em> are not filtered. Thus, it is strongly recommended to retrieve
   form values from the controls directly.
</div>

<h4 id="Chapter-5-1-Available-filters"><a href="#Chapter-5-1-Available-filters">5.1. Available filters</a></h4>
<p>
   As in previous releases, the APF shipps a couple of built-in filters. These usually cover the large
   part of the demands. Should these not be enough, own filters can be implemented. This is described
   in the next chapter.
</p>
<div class="hint">
   <p>
      Starting with release 1.14 the regular expressions of various filters can be adapted by 
      defining the expression within the <em>filter-expr</em> tag attribute on the target form control.
      This helps to avoid character set issues as duscussed within the 
      <a linkrewrite="false" class="forum" href="http://forum.adventure-php-framework.org/de/viewtopic.php?f=10&t=643#p6275">Forum</a>
      (German). 
   </p>
   <p>
      The subsequently listed filters do support overwriting the filter regexp:
   </p>
   <ul>
      <li>SpecialCharacterFilter</li>
      <li>OnlyNumbersFilter</li>
      <li>OnlyLettersFilter</li>
      <li>OnlyIntegersFilter</li>
      <li>NoSpecialCharactersFilter</li>
      <li>EMailFilter</li>
   </ul>
   <p>
      Further, charset sensitive function calls use the charset globally defined within theer
      <int:link pageid="067" />. 
   </p>
</div>
<p>
   Currently the following filters are available:
</p>

<h5 id="Chapter-5-1-1-EMailFilter"><a href="#Chapter-5-1-1-EMailFilter">5.1.1. EMailFilter</a></h5>
The <strong>EMailFilter</strong> removes all characters, that must not be contained in a valid email
address.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="EMailFilter"
      button="send"
      control="email"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-2-NoSpecialCharactersFilter"><a href="#Chapter-5-1-2-NoSpecialCharactersFilter">5.1.2. NoSpecialCharactersFilter</a></h5>
The <strong>NoSpecialCharactersFilter</strong> filters all characters, that to not comply with the
regexp <strong>[^0-9A-Za-z-_\.& ]</strong>.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="simplechars" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="NoSpecialCharactersFilter"
      button="send"
      control="simplechars"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-3-OnlyHTMLEntitiesFilter"><a href="#Chapter-5-1-3-OnlyHTMLEntitiesFilter">5.1.3. OnlyHTMLEntitiesFilter</a></h5>
Using the <strong>OnlyHTMLEntitiesFilter</strong> you can encode all special characters into their
HTML entity. Please note, that this filter may generate multiple encoding.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="htmlentitiestext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyHTMLEntitiesFilter"
      button="send"
      control="htmlentitiestext"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-4-OnlyIntegersFilter"><a href="#Chapter-5-1-4-OnlyIntegersFilter">5.1.4. OnlyIntegersFilter</a></h5>
The <strong>OnlyIntegersFilter</strong> only returns the numbers contained in the given text.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="zipcode" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyIntegersFilter"
      button="send"
      control="zipcode"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-5-OnlyLettersFilter"><a href="#Chapter-5-1-5-OnlyLettersFilter">5.1.5. OnlyLettersFilter</a></h5>
The <strong>OnlyLettersFilter</strong> removes all signs except normal characters.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="productcode" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyLettersFilter"
      button="send"
      control="productcode"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-6-OnlyNumbersFilter"><a href="#Chapter-5-1-6-OnlyNumbersFilter">5.1.6. OnlyNumbersFilter</a></h5>
The <strong>OnlyNumbersFilter</strong> only allows numbers and formatting signs such as dots or
commas.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:text name="productprice" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyNumbersFilter"
      button="send"
      control="productprice"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-7-SpecialCharacterFilter"><a href="#Chapter-5-1-7-SpecialCharacterFilter">5.1.7. SpecialCharacterFilter</a></h5>
The <strong>SpecialCharacterFilter</strong> filters all signs except normal characters and signs that
are needed for normal sentences.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:area name="simpletext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="SpecialCharacterFilter"
      button="send"
      control="simpletext"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-8-String2LowerFilter"><a href="#Chapter-5-1-8-String2LowerFilter">5.1.8. String2LowerFilter</a></h5>
The <strong>String2LowerFilter</strong> converts all characters to lowercase letters.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:area name="lowertext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="String2LowerFilter"
      button="send"
      control="lowertext"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-9-String2UpperFilter"><a href="#Chapter-5-1-9-String2UpperFilter">5.1.9. String2UpperFilter</a></h5>
The <strong>String2UpperFilter</strong> converts all characters to uppercase letters.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:area name="uppertext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="String2LowerFilter"
      button="send"
      control="uppertext"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>
<br />
<h5 id="Chapter-5-1-10-StripTagsFilter"><a href="#Chapter-5-1-10-StripTagsFilter">5.1.10. StripTagsFilter</a></h5>
Using the <strong>StripTagsFilter</strong> all HTML and PHP code fragments are filtered out. This
is especially good for text areas.
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:area name="notagstext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="StripTagsFilter"
      button="send"
      control="notagstext"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h5 id="Chapter-5-1-11-FloatFilter"><a href="#Chapter-5-1-11-FloatFilter">5.1.11. FloatFilter</a></h5>
<p>
   The <strong>FloatFilter</strong> can be used to convert the content of a text field into a
   floating number.
</p>
<div class="hint">
   This filter is especially interesting for providing text fields to type in floating numbers. It
   enables you to ommit additional conversion and validation.
</div>
<gen:highlight type="apf-xml">
&lt;html:form name="..."&gt;
   &lt;form:area name="length" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="FloatFilter"
      button="send"
      control="length"
   /&gt;
&lt;/html:form&gt;
</gen:highlight>

<h4 id="Chapter-5-2-Construction-of-filters"><a href="#Chapter-5-2-Construction-of-filters">5.2. Construction of filters</a></h4>
<p>
   Form filters are special filters, that are built on the APF filter API. Each form filter must
   implement the <strong>AbstractFormFilter</strong> class that acts as an interface for dedicated
   form filter implementations.
</p>
<p>
   Just like the form validators, form filters must implement some form-specific methods. The
   <strong>AbstractFormFilter</strong> interface class is as follows:
</p>
<gen:highlight type="php">
abstract class AbstractFormFilter extends AbstractFilter {

   protected $__Control;
   protected $__Button;

   public function AbstractFormFilter(form_control &$control,form_control &$button){
      $this->__Control = &$control;
      $this->__Button = &$button;
   }

   public function isActive(){
      return $this->__Button->isSent();
   }

}
</gen:highlight>
The constructor takes the control to filter and the button that triggers the element as arguments.
The <strong>filter()</strong> method is applied the content to filter included in the method. The
return param is expected to be the filtered content.
<br />
<br />
<strong>isActive()</strong> returns <em>true</em> in case the filter should be executed and
<em>false</em> otherwise.
<br />
<br />
The class members <strong>$__Control</strong> and <strong>$__Button</strong> contain the instance of
the form control to filter and the button, that is used as a trigger for the validation event. Thus,
these can easily be used within the filter code.
<br />
<br />
To be able to add a filter as an observer to a form control, the form control, must support this
operation. For this reason, each form element must implement the <strong>addFilter()</strong>
function. The signature of the method defined within the <strong>form_control</strong> class is as
follows:
<gen:highlight type="php">
public function addFilter(AbstractFormFilter &$filter){
   if($filter->isActive()){
      $value = $this->getAttribute('value');
      $filteredValue = $filter->filter($value);
      $this->setAttribute('value',$filteredValue);
   }
}
</gen:highlight>
As the code snippet describes, the method takes an instance of the filter as an argument. In case,
the filter is active (=button is clicked) the filter is executed.
<br />
<br />
Further, the filter is passed the content of the <strong>value</strong> attribute of the form control
<em>by default</em>. Thus, non-text fields re-implement the method to pass the right content to the
filter.
<br />
<br />
<div class="hint">
   Filters are usually applied on text fields. It is not recommended to apply filters to complex
   data structures and in case of select fields it may not be necessary at all. There, the content
   of the fields are filled by the application itself. Hence, the APF does not ship select field
   filters.
</div>
<br />
<br />
<h4 id="Chapter-5-3-Implementation-of-filters"><a href="#Chapter-5-3-Implementation-of-filters">5.3. Implementation of filters</a></h4>
As mentioned in the last chapters, a filter  must inherit from the <strong>AbstractFormFilter</strong>
class.
<br />
<br />
In order to implement custom filters, please remember the following topics:
<ul>
   <li>
      Each filter must inherit from the <strong>AbstractFormFilter</strong> class to be compatible
      with the APF filter API.
   </li>
   <li>
      The <strong>isSent()</strong> method can be used to query the click status of a given button
      within the desired form.
   </li>
   <li>
      The <strong>isActive()</strong> can be used to check, whether a filter is active or not. In
      most cases, the implementation defined within the <strong>AbstractFormFilter</strong> can be
      used without adaption.
   </li>
</ul>
<div class="hint">
   Due to the fact, that with PHP >=5.2.10 and >=5.3.0 respectively, the signatures of abstract
   methods must be exactly equal to their implementations. Thus, please ensure, that the filter
   classes have a method <em>public function filter($input)</em> defined as printed here literally!
</div>
<br />
<br />
<h3 id="Chapter-6-Usage-of-forms"><a href="#Chapter-6-Usage-of-forms">6. Usage of forms</a></h3>
Chapter <a href="./?Page=114-Usage-of-forms" title="Usage of forms">usage of forms</a> deals with
the usage of APF forms and the form handling using document controller. The present page is only
intended as a reference for the shipped tags and the implementation of validators and filters.
Further, the linked chapter discusses dynamic form implementation.
<br />
<br />
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="en_113" />