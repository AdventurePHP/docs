<doku:title parent="119" tags="dokumentation,klassen referenz,klassen,referenz,singleton,registry" title="Registry" urlname="Registry">
  Die Registry (siehe registry pattern) dient im Adventure PHP Framework als zentrale Stelle f&uuml;r
  die Speicherung von Konfigurationsparametern. Parameter sind in diesem Zusammenhang sowohl einfache
  Datentypen wie Zeichenketten und Zahlen als auch Objekte. Die Registry wird von den core- und
  tools-Komponenten dazu verwendet, die Konfigurationsdirektiven URLRewriting, URLBasePath,
  Environment, LogDir und LibPath im Namespace apf::core vorzuhalten. Die Registry dient jedoch
  nicht nicht nur als globale Speicherstelle f&uuml;r die Parameter des Frameworks, sondern kann
  auch in Applikationen zur Speicherung von Applikationskonfigurationen verwendet werden.
</doku:title>
<h3 id="Chapter-1-Einleitung"><a href="#Chapter-1-Einleitung">1. Einleitung</a></h3>
Die <strong>Registry</strong> (siehe registry pattern) dient im Adventure PHP Framework als zentrale
Stelle f&uuml;r die Speicherung von Konfigurationsparametern. Parameter sind in diesem Zusammenhang
sowohl einfache Datentypen wie Zeichenketten und Zahlen als auch Objekte. Die <strong>Registry</strong>
wird von den core- und tools-Komponenten dazu verwendet, die Konfigurationsdirektiven
<ul>
  <li><strong>URLRewriting</strong> (Konfiguration des URL-Rewriting)</li>
  <li><strong>URLBasePath</strong> (Pfad zur aktuellen Anwendung)</li>
  <li><strong>Environment</strong> (Umgebungsvariable f&uuml;r die Konfiguration)</li>
  <li><strong>LogDir</strong> (Pfad zum Log-Verzeichnis)</li>
  <li><strong>LibPath</strong> (Pfad zu den Quellcode-Dateien)</li>
  <li><strong>CurrentRequestURL</strong> (Vollst&auml;ndige Request-URL)</li>
</ul>
im Namespace <strong>apf::core</strong> vorzuhalten. Die Registry dient jedoch nicht nicht nur als
globale Speicherstelle f&uuml;r die Parameter des Frameworks, sondern kann auch in Applikationen zur
Speicherung von Applikationskonfigurationen verwendet werden.
<br />
<br />
<br />
<h3 id="Chapter-2-Einsatz-der-Registry"><a href="#Chapter-2-Einsatz-der-Registry">2. Einsatz der Registry</a></h3>
<div class="hint">
   Die <em>Registry</em> wurde im Release 1.12 aus Performance-Gr&uuml;nden auf eine statische
   Implementierung umgestellt. In allen vorherigen Releases muss diese via
   <gen:highlight type="php">$reg = &Singleton::getInstance('Registry');</gen:highlight>
   bezogen und als Objekt angesprochen werden. Hier stehen ebenfalls die Methoden <em>register()</em>
   und <em>retrieve()</em> zur Verf&uuml;gung. Diese besitzten eine zur neuen Implementierung
   identische Signatur.
</div>
Ab Release 1.12 steht die <em>Registry</em> als statischer Container zur Konfiguration von Parametern
des Frameworks und eigenen zur Verf&uuml;gung. Die Methode <strong>register()</strong> dient dazu,
bereits vorhandene Werte zu manipulieren oder neue Werte hinzuzuf&uuml;gen. Die Funktion
<strong>retrieve()</strong> bezieht Werte aus der Registry. Um eine definierte Abgrenzung zwischen
Wertebereichen zu schaffen, besitzt die <em>Registry</em> Namespaces. Um auch bei der Verwendung
durch weitere Applikationen keine &Uuml;berschneidung von Wertebereichen zu generieren, ist es ratsam,
den Namespace der Applikation als Namespace in der Registry zu verwenden.
<br />
<br />
Um die oben genannten Standard-Werte zu manipulieren, kann folgender PHP-Code eingesetzt werden:
<gen:highlight type="php">
Registry::register('apf::core','URLRewriting',true);
Registry::register('apf::core','URLBasePath','http://example.com/folder');
Registry::register('apf::core','Environment','TESTSERVER');
Registry::register('apf::core','LogDir','/path/to/my/log/dir');
</gen:highlight>
Bei der Manipulation der Standard-Werte oder auch von eigenen Registry-Eintr&auml;gen ist darauf zu
achten, dass diese vor dem Erstellen des Page- bzw. FrontControllers ge&auml;ndert werden.
<br />
<br />
<br />
<h3 id="Chapter-3-Schreibschutz"><a href="#Chapter-3-Schreibschutz">3. Schreibschutz</a></h3>
Um bei Eintr&auml;gen f&uuml;r eigene Applikationen sicher gehen zu k&ouml;nnen, dass diese w&auml;hrend
der Laufzeit nicht mehr ver&auml;ndert werden k&ouml;nnen, bietet die Registry einen Schreibschutz.
Dieser kann mit einem optionalen Parameter bei der Bef&uuml;llung eines Wertes aktiviert werden und
bleibt bis zum Ende des Requests erhalten. Hierzu kann folgendes Beispiel als Quellcode-Vorlage
hinzugezogen werden:
<gen:highlight type="php">
// Wird erfolgreich durchgef&uuml;hrt
Registry::register('modules::mymodule','MyModuleID',1,true);

// Erzeugt einen Fehler
Registry::register('modules::mymodule','MyModuleID',2);
</gen:highlight>
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="de_067" />