<doku:title parent="071" tags="tutorial,gaestebuch,taglibs,wiederverwendbarkeit,mehrsprachigkeit,frontcontroller" title="Gästebuch-Tutorial" urlname="Gaestebuch-Tutorial">
  Das Gästebuch-Tutorial ist eine umfassendes Dokumentation über die moderne
  Software-Architektur. Es behandelt den Entwicklungsprozess von der Erstellung der Anforderungen,
  über die Modellierung bis hin zur Implementierung einer fertigen Anwendung. Das Modul liegt
  dem Frameworkrelease im Ordner modules/guestbook bei.
</doku:title>
<p>
   Die folgenden Zeilen beschreiben ein weiteres, komplettes Anwendungsbeispiel, das in Zusammenarbeit mit
Alexander Heim (<a class="external" href="http://www.promadesign.com/">http://www.promadesign.com/</a>) entstanden ist.
Es gibt einen Einblick über das Design von Software und beschäftigt sich mit den
Implementierungs-Details, die das vorliegende Framework angehen.
</p>
<div class="hint">
   Hinweise zur Einbindung des Gästebuchs finden sich in der
   <int:link pageid="091">Komponenten-Dokumentation</int:link>.
</div>

<h3 id="Chapter-1-Einleitung"><a href="#Chapter-1-Einleitung">1. Einleitung</a></h3>
<p>
   Ein Gästebuch ist wahrscheinlich die älteste Anwendung von dynamischen Webseiteninhalten,
   die ich kennengerlernt habe, jedoch ist das Beispiel auch sehr umfassend und beinhaltet viele Design-
   Paradigmen und Pattern. Das Gästebuch basiert auf einer MySQL-Datenbank für die Daten-
   Speicherung, das Front- und Backend basiert auf dem hier dokumentierten und eingesetzten Framework.
   Das Grafik-Design ist bewusst sehr schlicht gehalten, damit die Anwendung in jede beliebige Webseite
   eingebunden werden kann und die eigentliche Funktion nicht zu sehr in den Hintergrund rückt.
</p>
<p>
   <strong>Hinweis:</strong> Die hier eingesetzte Software-Entwurfs-Methode mit Hilfe von UML ist nur eine gekürzte
   Form der sonst in der Industrie üblichen Form des Entwurfs. Weiterführende Literatur
   dazu ist auf <a class="external" href="http://www.amazon.de/Softwaretechnik-Praxiswissen-Softwareingenieure-Johannes-Siedersleben/dp/3446218432/ref=pd_bbs_sr_1/303-3160127-7394660?ie=UTF8&s=books&qid=1176130372&sr=8-1" title="Softwaretechnik von Johannes Siedersleben">amazon.de</a>
   (Softwaretechnik von Johannes Siedersleben) erhältlich.
</p>

<h3 id="Chapter-2-Anforderungen"><a href="#Chapter-2-Anforderungen">2. Anforderungen</a></h3>
Zu Beginn sollte der Entwickler zusammen mit dem Kunden - falls dies zwei unterschiedliche
Personen sind - die Anforderungen an die Software spezifizieren. Ist der Kunde der Entwickler selbst
ist es ebenso ratsam die Anforderungen an die Software zu dokumentieren. Üblicherweise werden
Anforderungen in sog. "functional requirements" und "non-functional requirements" gruppiert. Das
Software-Design soll sich hier durch folgende Punkte auszeichnen:
<ul>
  <li>
    <strong>Functional Requirements</strong>
    <ul>
      <li>Anzeigen der Einträge mit Paging</li>
      <li>Erstellen eines neuen Eintrags</li>
      <li>Administration des Gästebuchs (Kommentieren, Editieren, Löschen)</li>
      <li>Einbindung per Tag in eine bestehende Oberfläche</li>
    </ul>
  </li>
  <li>
    <strong>Non-Functional Requirements</strong>
    <ul>
      <li>Möglichkeit mehrere Gästebücher mit einem Code betreiben</li>
      <li>Modularer Aufbau</li>
      <li>Von der Anwendung getrenntes Datenhaltungs-Modell</li>
      <li>Gute Performance</li>
    </ul>
  </li>
</ul>
Der in der Liste genannte Pager ist ein weiteres mit dem Framework ausgeliefertes Modul im "modules"-
Namespace. Er ist eine fertig einsetzbare Business-Komponente, die nur noch für den Einsatzzweck
konfiguriert werden muss. Er unterstützt eine generische Schnittstelle zur Implementierung einer
eigenen Ausgabe-Logik. Für den aktuellen Anwendungsfall kann jedoch die bereits mitgelieferte
Ausgabe eingesetzt werden.
<br />
<br />
<br />
<br />
<h3 id="Chapter-3-Anwendungsfaelle"><a href="#Chapter-3-Anwendungsfaelle">3. Anwendungsfälle</a></h3>
Eine weitere Form, die Anforderungen auf Basis von Rollen auszudrücken ist das "Use Case"-Diagramm.
Diese spiegeln die Interaktions-Punkte von Personen mit dem Systen wieder und gruppieren Funktionen.
Die hier gezeigten Diagramme wurden mit dem <a class="external" href="http://www.sparxsystems.at/" title="Enterprise Architect">Enterprise Architect</a>
erstellt, ein Entwurfs-Tool, mit dem der komplette Entwurfszyklus elektronisch in UML dokumentiert
werden kann. Ebenso ist Code-Generation aus bestehenden Klassen-Diagrammen in viele Programmiersprachen
(u.a. PHP) möglich.
<br />
<br />
<br />
<strong>Übersicht</strong>
<br />
<br />
<img src="http://media.adventure-php-framework.org/content/use_case__overview.png" border="0" alt="Use Case Übersicht Gästebuch-Tutorial Adventure PHP Framework" />
<br />
<br />
<br />
<strong>Aktoren</strong>
<br />
<br />
<img src="http://media.adventure-php-framework.org/content/use_case__actors.png" border="0" alt="Use Case Akteure Gästebuch-Tutorial Adventure PHP Framework" />
<br />
<br />
<br />
<strong>Anwendungsfälle</strong>
<br />
<br />
<img src="http://media.adventure-php-framework.org/content/use_case__cases.png" border="0" alt="Use Case Fälle Gästebuch-Tutorial Adventure PHP Framework" />
<br />
<br />
<br />
<br />
<h3 id="Chapter-4-Businessschicht-und-Datenmodell"><a href="#Chapter-4-Businessschicht-und-Datenmodell">4. Design der Business-Schicht / Datenmodell der Anwendung</a></h3>
Die Business-Schicht einer Anwendung beinhaltet die Definition der Workflows und der Definition der
Daten-Objekte. Da sich der/die Workflow/s im Gästebuch auf realtiv wenige Aktionen und Folgen
von Aktionen (Eintragen -> Speichern -> Weiterleitung auf Anzeige-/Auswahl-Seite) beschränkt,
sei hier mehr auf das Daten-Design eingegangen.
<br />
<br />
Die Autoren gehen davon aus, dass das folgende Datenmodell für alle Anwendungsfälle
ausreichend ist:
<br />
<br />
<img src="http://media.adventure-php-framework.org/content/domain_model__domain_objects.png" border="0" alt="Domänen Objekte Gästebuch-Tutorial Adventure PHP Framework" />
<br />
<br />
Alle für die Anwendung relevanten Objekte (<strong>Guestbook</strong>, <strong>Entry</strong>
und <strong>Comment</strong>) erben vom Basis-Objekt <em>APFObject</em>. Damit erben diese bereits
die generischen <em>get()</em>- und <em>set()</em>-Methoden. Die Objekte im Einzelnen:
<br />
<br />
<strong>Guestbook:</strong>
<br />
Das Objekt, dass das Gästebuch repräsentieren besitzt Attribute für die Darstellung
(<strong>Name</strong>, <strong>Description</strong>), <strong>Admin_Username</strong> und
<strong>Admin_Password</strong> für die Administration des Gästebuchs und das komplexe
Attribut <strong>Entries</strong>, das eine Liste von <strong>Entry</strong>-Objekten hält.
<br />
<br />
<strong>Entry:</strong>
<br />
Das Objekt <strong>Entry</strong> repräsentiert einen Eintrag in einem Gästebuch. Es sind
sowohl Attribute für die Darstellung als auch für die Sortierung enthalten. Zudem enthält
es das komplexe Attribut <strong>Comments</strong> in dem eine Liste von Kommentaren enthalten ist,
sofern Kommentare zu einem Eintrag hinzugefügt wurden.
<br />
<br />
<strong>Comment:</strong>
<br />
Das Objekt <strong>Comment</strong> trägt die Inhalte eines Kommentars, der an einen Gästebuch-
Eintrag gehängt wurde.
<br />
<br />
<br />
Hier das Objekt-Modell der Anwendung:
<br />
<br />
<img src="http://media.adventure-php-framework.org/content/class_model__system_diagram.png" border="0" alt="System Diagramm Gästebuch-Tutorial Adventure PHP Framework" />
<br />
<br />
Das Diagramm beschreibt aktuell vier Komponenten, die implementiert werden müssen. Das sind je
ein Document-Controller für die Ausgabe der Liste und einer für das Handling des Formulars,
eine Business- (<em>GuestbookManager</em>) und eine Daten-Schicht-Komponente (<em>GuestbookMapper</em>).
Der Manager kapselt den Workflow, der im Wesentlichen aus der Methode <em>saveEntry()</em> besteht.
<br />
<br />
<br />
<br />
<h3 id="Chapter-5-Datenschicht"><a href="#Chapter-5-Datenschicht">5. Datenschicht und DataMapper</a></h3>
<p>
   Wie bereits angesprochen differieren in der Regel das Datenmodell der Anwendung und das der Datenhaltung.
   In diesem Fall wird ein normalisiertes Datenmodell in der dritten erweiterten Normalform
   eingesetzt. Das bedeutet, dass die Objekte jeweils in einer eigenen Tabelle gespeichert werden und die
   Beziehungen (in diesem Beispiel nur Kompositionen) über Relations-Tabellen. Siehe auch
   <a class="external" href="http://de.wikipedia.org/wiki/Normalisierung_%28Datenbank%29" title="Normalisierung bei Wikipedia">http://de.wikipedia.org/wiki/Normalisierung (Datenbank)</a>.
   Das ergibt unter Berücksichtigung des obigen Anwendungs-Daten-Modells folgende Tabellen-Struktur:
</p>
<img src="http://media.adventure-php-framework.org/content/database_model.png" border="0" alt="Datenmodell Gästebuch-Tutorial Adventure PHP Framework" />
<p>
   Der <strong>DataMapper</strong> hat nun gemäß Pattern-Definition eines DataMappers die
   Aufgabe zwischen dem Datenmodell der Datenhaltung und der Anwendung zu vermitteln. Dazu dienen
   einerseits die Methoden <em>mapEntry2DomainObject()</em>, <em>mapGuestbook2DomainObject()</em>
   und <em>__mapComment2DomainObject()</em>, mit denen die Result-Sets eines Datenbank-Queries in Objekte
   überführt werden, andererseits <em>loadGuestbookByID()</em>, mit dem ein komplettes
   Gästebuch incl. aller aktuell geforderten Einträge und Kommentare geladen werden kann.
</p>
<p>
   <strong>Fortsetzung:</strong>
   Das Design der Anwendung ist nun abgeschlossen. <int:link pageid="058" title="Implementierungsdetails">Seite 2</int:link>
   widmet sich den Implementierungsdetails.
</p>
<core:importdesign namespace="APF\modules\comments\pres\templates" template="comment" categorykey="de_057" />