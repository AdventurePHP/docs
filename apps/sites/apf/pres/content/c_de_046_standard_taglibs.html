<doku:title parent="119" tags="taglibs,standard taglibs,addtaglib,importdesign,formulare,form tags,form,getstring,createobject,document controller,page controller,front controller,documentcontroller,pagecontroller,frontcontroller,iterator,model based view concept,validator" title="Standard TagLibs" urlname="Standard-TagLibs">
  Die Standard-TagLib-Seite beinhaltet die Dokumentation zu den verfügbaren TagLibs. Zu diesen
  zählen Tags für die Einbindung von weiteren Templates, Formular-Tags, die Definition
  eines Controllers gemäß MVC, ein Model-based View-Konzept über den FrontController
  und die Beschreibung des Iterator-Tags.
</doku:title>
Folgende TagLib-Tags stehen zur Verfügung. In nicht selbstschließenden Tags sind alle HTML-
Tags und -Formatierungen erlaubt. Die Tags können mit den üblichen HTML-Attributen ausgestattet
werden, sofern diese für die Ausgabe oder Funktion relevant sind.
<br />
<br />
<div class="hint">
<strong>Hinweis:</strong> Bitte beachten Sie, dass innerhalb von Tag-Definitionen ausschließlich
Leerzeichen eingesetzt werden dürfen. Tabs oder Zeilenumbrüche werden nicht erkannt und es
kommt u.U. zu Fehlern beim Auslesen der Tag-Definitionen!
</div>
<br />
<h3 id="Chapter-1-Core"><a href="#Chapter-1-Core">1. Core</a></h3>
<h4 id="Chapter-1-1-Addtaglib"><a href="#Chapter-1-1-Addtaglib">1.1. Addtaglib</a></h4>
TagLibs sind nur innerhalb eines Dokuments des Objektbaums gültig. Um eine selbst implementierte
TagLib im aktuellen Dokument einbinden zu können wird folgender Tag verwendet. Dieser sollte
möglichst am Anfang des Dokuments plaziert sein, da Tags erst nach erfolgreicher Einbindung einer
TagLib geparst werden können.
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="" prefix="" class="" /&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Ein mit "::" getrennter Namespace-Pfad.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML-Prefix
    (<strong>Zeichen</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML-Klasse
    (<strong>Zeichen</strong>: <code>[a-z]</code>)
  </li>
</ul>
Die vom Entwickler erzeugte TagLib-Klasse muss die Form "&lt;prefix&gt;_taglib_&lt;class&gt;" haben. Die
innerhalb der Klasse zu implementierenden Methoden sind der API-Dokumentation zu entnehmen. In der Regel
wird das Tag für die Einbindung der Form-TagLib verwendet. Eigene Taglibs machen vor allem dann Sinn,
wenn eigene abgetrennte Bereiche einer Applikation mehrfach verwendbar gemacht werden wollen (z.B. Warenkorb).
<br />
<br />
<br />
<h4 id="Chapter-1-2-Importdesign"><a href="#Chapter-1-2-Importdesign">1.2. Importdesign</a></h4>
Möchte der Template-Bauer an einer definierten Stelle ein weiteres Document einfügen, so
kann der Tag
<gen:highlight type="apf-xml">
&lt;core:importdesign namespace="" template="" [incparam=""] [context=""]/&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Ein mit "::" getrennter Namespace-Pfad.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>template</strong>: Name eines Templates.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>incparam</strong>: URL-Parameter der abgefragt wird, welches Template eingebunden werden soll.
  </li>
  <li>
     <strong>context</strong>: Setzt den Context ab dem durch den Tag erzeugten APF-DOM-Knoten
     auf den angegebenen Context.
  </li>
</ul>
verwendet werden. Wird bei der Definition des Tags ein sog. pagepart-Template definiert, kann ein
Template abhängig vom URL-Parameter eingebunden werden. Standard-Parameter ist "pagepart",
dieser kann jedoch mit dem optionalen Attribut "incparam" angepasst werden. Beispiel für die
Einbindung mit pagepart-Parameter:
<gen:highlight type="apf-xml">
&lt;core:importdesign namespace="sites::testsite::pres::templates" template="[pagepart = test]" /&gt;
&lt;core:importdesign namespace="sites::testsite::pres::templates" template="[cmsmodule = test]" \
 incparam="cmsmodule" /&gt;
</gen:highlight>
Das eingebundene Template erbt automatisch die Eigenschaften des Vater-Objekts. Insbesondere Context und
Sprache werden übertragen.
<br />
<br />
<div class="hint">
Das Attribut <strong>context</strong> sollte dann eingesetzt werden, wenn die Notwendigkeit besteht,
ein Modul innerhalb einer Applikation mehrmals und mit unterschiedlichen Konfiguration einzusetzen.
Dabei sollten die Module durch die Importdesign-Taglib oder eine abgeleitete Klasse eingebunden
und mit dem gewünschten Context versort werden. Alle unterhalb des Knotens angelegten APF-DOM-Knoten
werden dann mit dem in den Tag-Attributen gesetzten Context versorgt und können wie gewohnt auf die
gewünschten Konfigurationen zugreifen.
</div>

<h4 id="Chapter-1-3-Setattribute"><a href="#Chapter-1-3-Setattribute">1.3. Setattribute</a></h4>
<p>
   Der Tag <em>&lt;core:setattribute /&gt;</em> erlaubt es, die Attribute des Eltern-Dokuments im
   DOM-Baum zu manipulieren.
</p>
<gen:highlight type="apf-xml">
&lt;core:setattribute name="" value="" /&gt;
</gen:highlight>
<p>Um das Tag verwenden zu können muss die TagLib zunächst via</p>
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="core::pagecontroller" prefix="core" class="setattribute" /&gt;
</gen:highlight>
<p>eingebunden werden.</p>

<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>name</strong>: Name des Attributes.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
  <li>
    <strong>value</strong>: Wert des Attributes.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_:.]</code>)
  </li>
</ul>

<h3 id="Chapter-2-Html"><a href="#Chapter-2-Html">2. Html</a></h3>
<h4 id="Chapter-2-1-Placeholder"><a href="#Chapter-2-1-Placeholder">2.1. Placeholder</a></h4>
Um in einem Document-Controller Inhalte dynamisch füllen zu können gibt es den html:placeholder-
Tag.
<gen:highlight type="apf-xml">
&lt;html:placeholder name="" /&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>name</strong>: Name des Platzhalters. Über den Namen kann auf das Element zugegriffen werden.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<br />
Um einen Platzhalter mit Inhalt zu füllen kann man in einem Document-Controller folgendes einbauen:
<gen:highlight type="php">
  $this->setPlaceHolder('NameDesPlatzhalters','InhaltDesPlatzHalters');
</gen:highlight>
<br />
<h4 id="Chapter-2-2-Getstring"><a href="#Chapter-2-2-Getstring">2.2. Getstring</a></h4>
Der Tag "html:getstring" dient dazu einen Konfigurations-String aus einer sprachabhängigen
Konfigurations-Datei auszulesen und anzuzeigen. So können auf einfache Weise mehrsprachige
Anwendungen aufgebaut werden.
<gen:highlight type="apf-xml">
&lt;html:getstring namespace="" config="" entry="" /&gt;
</gen:highlight>
Um das Tag verwenden zu können muss die TagLib "html:getstring" erst via
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="tools::html::taglib" prefix="html" class="getstring" /&gt;
</gen:highlight>
eingebunden werden.
<br />
<br />
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace der Konfigurationsdatei.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name der Konfigurationsdatei.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name des Konfigurations-Offsets.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>
<br />
Die sprachabhängige Konfigurationsdatei muss jeweils eine Sektion pro Sprache (zweistelliger
ISO-Länder-Code) und die verwendeten Konfigurationsschlüssel in den Sektionen enthalten
sein. Soll der Tag
<gen:highlight type="apf-xml">
  &lt;html:getstring namespace="modules::mymodule" config="language.ini" entry="title" /&gt;
</gen:highlight>
zur Anzeige eines sprachabhängigen Titels in einem Template genutzt werden, muss die
Konfigurationsdatei
<gen:highlight type="code">
/config/modules/mymodule/{CONTEXT}/{ENVIRONMENT}_language.ini
</gen:highlight>
mit dem Inhalt
<gen:highlight type="ini">
[de]
title = "Mein Modul"

[en]
title = "My module"
</gen:highlight>
gefüllt werden. Diese Beschreibung gilt ebenso für die Tags
<strong>&lt;form:getstring /&gt;</strong> (Kapitel 2.4.19.) und <strong>&lt;template:getstring /&gt;</strong>
(Kapitel 2.3.3.).
<br />
<br />
<br />
<h4 id="Chapter-2-3-Template"><a href="#Chapter-2-3-Template">2.3. Template</a></h4>
<h5 id="Chapter-2-3-1-Basis-Funktionen"><a href="#Chapter-2-3-1-Basis-Funktionen">2.3.1. Basis-Funktionen</a></h5>
Um weitere Elemente für die Ausgabe-Steuerung definieren zu können gibt es so genannte
Templates. Diese können innerhalb eines Document-Controllers manipuliert und verarbeitet werden.
In einem Template gibt es wiederum Platzhalter, die dynamisch gesetzt werden können.
<gen:highlight type="apf-xml">
&lt;html:template name=""&gt;
  [&lt;template:placeholder name="" /&gt;]
  [&lt;template:addtaglib namespace="" prefix="" class="" /&gt;]
&lt;/html:template&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>name</strong>: Name des Templates bzw. des Platzhalters innerhalb des Templates. Über
    den Namen kann auf das Element zugegriffen werden.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<p>
   Zugriff auf ein Template gewährt die geschützte Methode <em>getTemplate()</em> eines Document-Controllers.
   Mit Hilfe dieser Funktion kann eine Referenz auf ein Template-Objekt zurückgeliefert werden. Ein
   typischer Anwendungsfall sieht so aus:
</p>
<strong>Template:</strong>
<gen:highlight type="apf-xml">
&lt;@controller namespace="" file="" class="" @&gt;
&lt;html:placeholder name="Content" /&gt;

&lt;html:template name="MyTemplate"&gt;
  &lt;template:placeholder name="MyPlaceHolder"&gt;
&lt;/html:template&gt;
</gen:highlight>
<strong>Controller:</strong>
<gen:highlight type="php">
class my_controller extends base_controller {
   public function transformContent(){
      $Template__MyTemplate = &$this->getTemplate('MyTemplate');
      $Template__MyTemplate->setPlaceHolder('MyPlaceHolder','MyContent');
      $this->setPlaceHolder('Content',$Template__MyTemplate->transformTemplate());
   }
}
</gen:highlight>
Hier wird in der XML-Datei ein Document-Controller, ein HTML-Platzhalter und ein Template mit zugehörigem
Platzhalter definiert. Im Controller kann man nun mittels der Methoden <em>getTemplate()</em> eine Referenz
auf das Template holen und mit <em>setPlaceHolder()</em> den Platzhalter im Template füllen.
Anschließend wird das Template transformiert und die Ausgabe in den HTML-Platzhalter mittels
<em>setPlaceHolder()</em> eingesetzt. Es ist möglich mehrere Templates auf einer Seite zu platzieren.
Oft wird das für die Ausgabe von unterschiedlichen Meldungen bei unterschiedlichen Events
eingesetzt.
<br />
<br />
<br />
<h5 id="Chapter-2-3-2-Template-Erweiterungen"><a href="#Chapter-2-3-2-Template-Erweiterungen">2.3.2. Template-Erweiterungen</a></h5>
Um die Funktionalitäten innerhalb eines Templates mit weiteren TagLibs erweitern zu können
steht der Tag "&lt;template:addtaglib /&gt;" zur Verfügung. Ähnlich dem "&lt;core:addtaglib /&gt;"-
Tag können hier innerhalb eines Templates weitere TagLibs hinzugefügt werden.
<gen:highlight type="apf-xml">
&lt;template:addtaglib namespace="" prefix="" class="" /&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Ein mit "::" getrennter Namespace-Pfad.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML-Prefix
    (<strong>Zeichen</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML-Klasse
    (<strong>Zeichen</strong>: <code>[a-z]</code>)
  </li>
</ul>
Ein Beispiel für die Verwendung des XML-Tags ist der TagLib-Tag &lt;[html|template]:getstring /&gt;
zum Auslesen und Darstellen eines Strings aus einer Konfigurations-Datei.
Siehe hierzu Kapitel 2.2.3. bzw. 2.4.
<br />
<br />
<br />
<h5 id="Chapter-2-3-3-Getstring"><a href="#Chapter-2-3-3-Getstring">2.3.3. Getstring</a></h5>
Der Tag "template:getstring" dient dazu einen Konfigurations-String aus einer sprachabhängigen
Konfigurations-Datei auszulesen und anzuzeigen. So können auf einfache Weise mehrsprachige
Anwendungen aufgebaut werden.
<gen:highlight type="apf-xml">
&lt;template:getstring namespace="" config="" entry="" /&gt;
</gen:highlight>
Um das Tag verwenden zu können muss die TagLib "template:getstring" erst via
<gen:highlight type="apf-xml">
&lt;template:addtaglib namespace="tools::html::taglib" prefix="template" class="getstring" /&gt;
</gen:highlight>
eingebunden werden.
<br />
<br />
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace der Konfigurationsdatei.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name der Konfigurationsdatei.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name des Konfigurations-Offsets.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>
<br />
<h4 id="Chapter-2-4-Form"><a href="#Chapter-2-4-Form">2.4. Form</a></h4>
Die im Release mitgelieferten Formular-Taglibs können unter <int:link pageid="113" /> eingesehen
werden und wurden aus Gründen der Übersichtlichkeit von dieser Seite entfernt.
<div class="warn">
   Nutzen Sie noch die Formular-Taglibs des Release 1.10, so finden sie die vorhanden Formular-Taglibs
   unter <int:link pageid="130" />. Bitte beachten Sie zum Einsatz der alten Taglibs mit dem neuen
   APF-Release das
   <a class="wiki" href="http://wiki.adventure-php-framework.org/de/Formular-Taglibs_aus_1.10_mit_dem_Release_1.11_nutzen" title="Formular-Taglibs aus 1.10 mit dem Release 1.11 nutzen">HOWTO im Wiki</a>.
</div>
<h3 id="Chapter-3-Document"><a href="#Chapter-3-Document">3. Document</a></h3>
<h4 id="Chapter-3-1-createobject"><a href="#Chapter-3-1-createobject">3.1. createobject</a></h4>
Der Tag erzeugt aus einer Inhalts-Datei unter dem Ordner <strong>./frontend/content/</strong> einen
weiteren Unter-Objektbaum. Die Inhalts-Dateien werden in der Form
<gen:highlight type="code">
c_{LANGCODE}_{NAME}.html
</gen:highlight>
erwartet, wobei
<ul>
  <li><strong>LANGCODE</strong> für ein zweizeichen Länderkürzel (de, en, it, es, ...) steht und</li>
  <li><strong>NAME</strong> der URL-Name ist.</li>
</ul>
<gen:highlight type="apf-xml">
&lt;doc:createobject requestparam="" defaultvalue="" /&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>requestparam</strong>: URL-Parameter, der angibt, welche Content-Datei gezogen wird. (<strong>Zeichen</strong>: <code>[A-Za-z0-9]</code>)
  </li>
  <li>
    <strong>defaultvalue</strong>: Default-Wert für den Parameter <em>requestparam</em>.
  </li>
</ul>
Um die TagLib verwenden zu können muss diese mit einem
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="tools::html::taglib" prefix="doc" class="createobject" /&gt;
</gen:highlight>
in der Template-Datei eingebunden werden.
<br />
<br />
<div class="hint">
   Wird keine zum zu <strong>requestparam</strong> passende Datei im Ordner gefunden, erwartet der 
   Tag eine Datei mit dem Namen <gen:highlight type="code">c_{LANGCODE}_404.htm</gen:highlight>
   um anzeigen zu können, dass die gewünschte Seite nicht verfügbar ist. Ist auch 
   diese Datei nicht verfügbar kommt es zu einem PHP-Fehler.
</div>
<br />
<h3 id="Chapter-4-Document-Controller"><a href="#Chapter-4-Document-Controller">4. Document-Controller</a></h3>
Um einem Dokument einen Controller zu deklarieren muss folgender Tag am Anfang des Templates platziert
werden:
<gen:highlight type="apf-xml">
&lt;@controller namespace="" file="" class="" @&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace-Pfad zum Controller. (<strong>Zeichen</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>file</strong>: Datei-Namen in dem der Controller residiert. (<strong>Zeichen</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>class</strong>: Klassen-Namen des Controllers. (<strong>Zeichen</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
</ul>
Die Implementierung des Document-Controllers muss immer vom <em>base_controller</em> ableiten. Dieser ist
bereits im Page-Controller definiert und stellt grundlegende Methode für das Handling von DOM-
Objekten bereit. Beispiel hierfür ist die <em>getForm()</em>-Methode, die eine Referenz auf ein
Formular zurückgibt.
<br />
<br />
<br />
<h3 id="Chapter-5-Front-Controller"><a href="#Chapter-5-Front-Controller">5. FrontController</a></h3>
Mit dem Release 1.4-18.11.2007 wurde der Tag "&lt;fcon:importdesign /&gt;" eingefügt. Dieser
unterstützt bei der Implementierung von FrontController-basierten Applikationen und bindet Views
auf Grund von Model-Informationen im Sinne des MVC-Pattern ein. Hierzu muss eine eigene Model-Klasse
für die aktuelle Applikation oder das eingebundene Modul erstellt werden, aus dem die
Informationen für die Einbindung des Views bezogen werden können. Die Steuerung der
View-Einbindung wird typischerweise durch eigene FrontController-Actions geregelt, die im Modus
"prepagecreate" (siehe <a href="./?Seite=012-Frontcontroller" title="FrontController">FrontController</a>,
Kapitel 1.6) ausgeführt wird. Diese kann in der URL enthaltene Parameter an das Model-Objekt
weitergeben.
<gen:highlight type="apf-xml">
  &lt;fcon:importdesign
      templatenamespace=""
      modelnamespace=""
      modelfile=""
      modelclass=""
      modelparam=""
      [sessionsingleton=""]
  /&gt;
</gen:highlight>
<strong>Beschreibung der Attribute:</strong>
<ul>
  <li>
    <strong>templatenamespace</strong>: Namespace zum Template-Ordner.
    (<strong>Zeichen:</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>modelnamespace</strong>: Namespace zur Model Klasse.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>modelfile</strong>: Name der Datei, in der sich die Model-Klasse befindet.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>modelclass</strong>: Name der Model-Klasse.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>modelparam</strong>: Model-Parameter, der für die Einbindung des Templates verwendet werden soll.
    (<strong>Zeichen</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>sessionsingleton</strong>: Definiert, ob das Model-Objekt im SINGLETON oder SESSIONSINGLETON
    Modus vom ServiceManager bezogen werden soll. Ist das Attribut nicht vorhanden oder enthält
    es einen anderen Wert als <strong>true</strong>, so wird der SINGLETON Modus verwendet.
    (<strong>Werte</strong>: <code>true|false</code>)
  </li>
</ul>
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="de_046" />