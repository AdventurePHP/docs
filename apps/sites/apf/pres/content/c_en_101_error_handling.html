<doku:title parent="119" tags="error,handling,error handling,registry,core,errorhandler" title="Error handling" urlname="Error-handling">
  The error handling chapter describes the error handling contained in the framework to handle
  errors triggered by the application. Further, this section describes the usage of the concept and
  the extension.
</doku:title>
<h3 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction">1. Introduction</a></h3>
The framework features the <strong>errorHandler</strong> function, that is intended to do global
error handling. This function is used to catch and handle errors at a central place. For this
reason, it uses a <strong>ErrorHandler</strong> component, that can be configured within the registry.
The error handler itself is then responsible for the handling of the current error.
<br />
<br />
The preconfigured APF error handler saves the error message into a log file and displays the nice
error screen including the stacktrace. Details can be taken from the
<a href="./?Page=002-API-documentation" title="API documentation">API documentation</a> of the
<strong>DefaultErrorHandler</strong> class.
<br />
<br />
<br />
<h3 id="Chapter-2-Configuration"><a href="#Chapter-2-Configuration">2. Configuration</a></h3>
To replace the preconfigured <strong>DefaultErrorHandler</strong> with an own class, the registry offset
<strong>ErrorHandler</strong> within the <strong>apf::core</strong> namespace must be filled with the
desired <strong>ErrorHandlerDefinition</strong> instance. The configuration of the error handling
component must be placed in the bootstrap file directly after the <em>pagecontroller.php</em> is
included.
<br />
<br />
The definition of a custom error handler looks as follows:
<gen:highlight type="php">
Registry::register(
   'apf::core',
   'ErrorHandler',
   new ErrorHandlerDefinition(
      'my::errorhandler::namespace',
      'MyErrorHandler'
   )
);
</gen:highlight>
As you can take from the example, the desired <em>ErrorHandler</em> is referenced by it's
namespace and it's class name.
<br />
<br />
<strong>Note:</strong> if the registry offset does not contain a valid definition, the errors are
displayed in text mode. You can identify the fallback mode by the prefix
<gen:highlight type="apf-xml">
APF catchable error:
</gen:highlight>
In this cases, the definition or the implementation of the error handler class must be checked.
<br />
<br />
<div class="hint">
   In order to deactivate the <em>ErrorHandler</em>, initilize the registry offset with
   <strong>null</strong>.
   <br />
   <br />
</div>
<br />
<br />
<h3 id="Chapter-3-Enhancement"><a href="#Chapter-3-Enhancement">3. Enhancement</a></h3>
To introduce a custom error handling, you must implement the <strong>AbstractErrorHandler</strong>.
This class defines the following interface:
<gen:highlight type="php">
class AbstractErrorHandler extends APFObject {

   function handleError($errorNumber,$errorMessage,$errorFile,$errorLine){
   }

}
</gen:highlight>
If an error occures, the <strong>handleError</strong> is applied the following parameters:
<ul>
  <li>error number</li>
  <li>error message</li>
  <li>filename where the error occures</li>
  <li>line where the error occures</li>
</ul>
Due to the fact, that the error handling is done in an page controller independent class, that is
not created by the service manager, the current <strong>Context</strong> and the current
<strong>Language</strong> are <em>not</em> available!
<br />
<br />
If these information are important for the error handling, the must be obtained from information
containers available within an application or module (e.g. application model class). The environment
param is available via the registry as mentioned in the corresponding documentation chapter.
<br />
<br />
<br />
<h3 id="Chapter-4-Usage"><a href="#Chapter-4-Usage">4. Usage</a></h3>
The global error handling mechanism can be used by calling the PHP function
<gen:highlight type="php">
trigger_error();
</gen:highlight>
Details on the usage of the function can be taken from the online documentation under
<doku:link>http://php.net/trigger_error</doku:link>.
<br />
<br />
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="en_101" />