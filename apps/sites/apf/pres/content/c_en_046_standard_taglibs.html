<doku:title parent="119" tags="taglibs,standard taglibs,addtaglib,importdesign,forms,form tags,form,getstring,createobject,document controller,page controller,front controller,documentcontroller,pagecontroller,frontcontroller,iterator,model based view concept,validator" title="Standard taglibs" urlname="Standard-taglibs">
  The standard taglibs page contains the documentation of the taglibs that are shipped with each
  release. Among these are tags to integrate further templates, form tags, the document controller
  definition tag and front controller tag, that can dynamically inlude view templates by front
  controller model parameters. At least the iterator tag is introduced.
</doku:title>
This chapter describes the taglib tags available out-of-the-box. Within not self-closing tags all
HTML tags and formatting are permitted. All tags can be equipped with the usual HTML attributes,
provided that these are relevant for the issue or function.
<br />
<br />
<div class="hint">
<strong>Note:</strong> Please be aware, that within a tag definition only spaces are allowed as a
seperator. Tabs or new line characters are not parsed and using them can lead to unrecognized error
on tag definition analysis!
</div>
<br />
<h3 id="Chapter-1-Core"><a href="#Chapter-1-Core">1. Core</a></h3>
<h4 id="Chapter-1-1-Addtaglib"><a href="#Chapter-1-1-Addtaglib">1.1. Addtaglib</a></h4>
Taglibs are only "valid" within a specific document of the object tree. That means, that the parser
methode <strong>__extractTagLibTags()</strong> only parses the taglibs known in one specific node.
To be able to integrate a self-implemented taglib in the present document the following tag is used.
This XML tag should be placed possibly at the beginning of the document, or at least befor it is used
because of tag can only be successfully integrated after the taglib is parsed.
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="" prefix="" class="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path seperated with "::".
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML prefix
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML class
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
</ul>
Taglib classes generated by the developer must be named like "&lt;prefix&gt;_taglib_&lt;class&gt;".
Thereby, <strong>&lt;prefix&gt;</strong> is the prefix and <strong>&lt;class&gt;</strong> identifies
the class of the XML tag used to inside a template. The methods to be implemented within the class
are to be taken from the API documentation. In common the tag is used for the integration of the form
taglib or to load user specific taglibs. Own taglibs are usualy created, when a application needs to
be separated into independent parts and these want to be used in different contexts or modules of the
application.
<br />
<br />
<br />
<h4 id="Chapter-1-2-Importdesign"><a href="#Chapter-1-2-Importdesign">1.2. Importdesign</a></h4>
To include another template into a certain place in the space of a present template the tag
<gen:highlight type="apf-xml">
&lt;core:importdesign namespace="" template="" [incparam=""] [context=""]/&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path seperated with "::".
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>template</strong>: Name of the desired template.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>incparam</strong>: URL parameter that is used for template inclusion.
  </li>
  <li>
     <strong>context</strong>: Redefines the context starting with the current DOM node.
  </li>
</ul>
can be used. If a so-called pagepart template is defined with the definition of this tag, a template
can be integrated depending by the specified URL parameter. Standard parameter is "pagepart",
nevertheless, this can be adapted with the optional attribute "incparam". Example of the integration
with the pagepart parameter is:
<gen:highlight type="apf-xml">
&lt;core:importdesign namespace="sites::testsite::pres::templates" template="[pagepart = test]" /&gt;
&lt;core:importdesign namespace="sites::testsite::pres::templates" template="[cmsmodule = test]" \
 incparam="cmsmodule" /&gt;
</gen:highlight>
The integrated template automatically inherits the qualities of the father's object. In particular
context and language will be adopted.
<br />
<br />
<div class="hint">
The <strong>context</strong> should be used, if you are inteded to use a module twice within one
application/website with different configuration. Doing so, the module should be included using the
importdesign taglib or a derived class to provide the correct context to the module. Please note,
that all taglibs below this DOM node are initialized with the manually configured context and thus
can access context and environment dependent configuration.
</div>

<h3 id="Chapter-2-Html"><a href="#Chapter-2-Html">2. Html</a></h3>
<h4 id="Chapter-2-1-Placeholder"><a href="#Chapter-2-1-Placeholder">2.1. Placeholder</a></h4>
To be able to fill contents in a document controller dynamically the tag "html:placeholder" was
introduced.
<gen:highlight type="apf-xml">
&lt;html:placeholder name="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the place holder. The name is used to access this place holder
    within a document controller.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<br />
To fill a place holder with contents you can insert the following instruction in a document controller:
<gen:highlight type="php">
$this->setPlaceHolder('NameOfThePlaceHolder','ContentOfThePlaceHolder');
</gen:highlight>

<h5 id="Chapter-2-2-Getstring"><a href="#Chapter-2-2-Getstring">2.2. Getstring</a></h5>
<p>
   The tag <em>&lt;html:getstring /&gt;</em> gives the opportunity to read a configuration string from a
   language-dependent configuration file and so create multi-language GUIs. The behavior is identical to
   the <em>&lt;template:getstring /&gt;</em> tag described in chapter 2.2.3.
</p>
<gen:highlight type="apf-xml">
&lt;html:getstring
   [name=""]
   namespace=""
   config=""
   entry="" /&gt;
</gen:highlight>

<strong>Description of the attributes:</strong>
<ul>
   <li>
      <strong>name</strong>: Name of the place holder as identifier for the <em>getLabel()</em> method
      (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
   </li>
   <li>
    <strong>namespace</strong>: Namespace of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name of the configuration.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name of the configuration key.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>
<div class="warn">
   Please note, that the <em>name</em> attribute can be used as of version 1.15 earliest and in conjunction with the
   <em>getLabel()</em> methode.
</div>
<div class="hint">
   <p>
      To use the tag in releases &lt; 1.15 it must be announced using the
   </p>
<gen:highlight type="apf-xml">
&lt;core:addtaglib
   namespace="tools::html::taglib"
   prefix="html"
   class="getstring"
/&gt;
</gen:highlight>
   <p>
      directive.
   </p>
</div>
<p>
   The language dependent configuration file must contain one section per language (two-letter ISO
   country code) and the configuration keys used in the tag within each of the language sections. If
   the tag
</p>
<gen:highlight type="apf-xml">
&lt;html:getstring namespace="modules::mymodule" config="language.ini" entry="title" /&gt;
</gen:highlight>
<p>
   should display a multilangual title within a template, the configuration file
</p>
<gen:highlight type="code">
/config/modules/mymodule/{CONTEXT}/{ENVIRONMENT}_language.ini
</gen:highlight>
<p>
   must be filled with the content
</p>
<gen:highlight type="ini">
[de]
title = "Mein Modul"

[en]
title = "My module"
</gen:highlight>


<p>
   Since release 1.15 language-dependent texts can be added place holders that can be filled dynamically within a
   <int:link pageid="006"/> at runtime. The place holder is defined by it's name enclosed by brackets:
</p>
<gen:highlight type="code">
{user-name}
</gen:highlight>
<p>
   This place holder can be referred to by it's key <em>user-name</em> later on. Please note the subsequent language
   text file that defines three keys including one or more place holders:
</p>
<gen:highlight type="ini">
[en]
headline = "This is a {word}"
intro.text = "This is a text with {count} place holder."
message = "This is a message from {user-name} sent at {date}."
...
</gen:highlight>
<p>
   The values defined above can be used within your template files as follows:
</p>
<gen:highlight type="apf-xml">
&lt;h3&gt;&lt;html:getstring
       name="headline"
       namespace="..."
       config="..."
       entry="headline"/&gt;&lt;/h3&gt;
&lt;html:form name="Form"&gt;
   &lt;p&gt;
      &lt;form:getstring
             name="intro-text"
             namespace="..."
             config="..."
             entry="intro.text"/&gt;
   &lt;/p&gt;
   ...
&lt;/html:form&gt;
&lt;html:template name="Message"&gt;
   ...
   &lt;p&gt;
      &lt;template:getstring
            name="message"
            namespace="..."
            config="..."
            entry="message"/&gt;
   &lt;/p&gt;
   &lt;/html:template>
</gen:highlight>
<p>
   To fill the place holders you are provided several possibilities as you can take from the below document controller.
   They all use the <em>getLabel()</em> method to obtain an instance of the appropriate label tag. The instance itself
   provides the <em>setPlaceHolder()</em> function that takes the name and the value as it's arguments. You may use the
   method in <em>fluid interface</em> style to add more than one place holder:
</p>
<gen:highlight type="php">
class sample_controller extends base_controller {
   public function transformContent() {

      // Fill place holder within a < html:getstring /> directly within the template:
      $this->getLabel('headline')->setPlaceHolder('word', 'Headline');

      // Fill place holder within a < form:getstring /> within a form:
      $form = &$this->getForm('Form');
      $form->getLabel('intro-text')->setPlaceHolder('count', 'one');

      // Fill place holder within a < template:getstring /> within a template tag:
      $tmpl = &$this->getTemplate('Message');
      $tmpl->getLabel('message')
           ->setPlaceHolder('user-name', 'John')
           ->setPlaceHolder('date', date('d.m.Y H:i:s'));
   }
}
</gen:highlight>
<div class="hint">
   The number of place holders per language key is not restricted. Place holders that are not filled are displayed
   literally within the output.
</div>
<p>
   This description of this tag can also be applied to the tags <em>&lt;form:getstring /&gt;</em>
   (<int:link pageid="113" anchor="Chapter-3-17-Getstring"/>) and <em>&lt;template:getstring /&gt;</em>
   (<a href="Chapter-2-3-3-Getstring">chapter 2.3.3.</a>).
</p>

<h4 id="Chapter-2-3-Template"><a href="#Chapter-2-3-Template">2.3. Template</a></h4>
<h5 id="Chapter-2-3-1-Basic-functions"><a href="#Chapter-2-3-1-Basic-functions">2.3.1. Basic functions</a></h5>
To be able to define further reusable elements the so-called templates are introduces. These can be
manipulated and be processed within a document controllers. Each template again has place holders
than can be filled dynamically.
<gen:highlight type="apf-xml">
&lt;html:template name=""&gt;
  [&lt;template:placeholder name="" /&gt;]
  [&lt;template:addtaglib namespace="" prefix="" class="" /&gt;]
&lt;/html:template&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the templates of name of the place holder within a templates. The
    name is used to access this object within a document controller.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<p>
   Access to a template grants the protected method <em>getTemplate()</em> of a document controller.
   With the help of this function a reference on a template object can be gathered. A typical
   application case looks like this:
</p>
<strong>Template:</strong>
<gen:highlight type="apf-xml">
&lt;@controller namespace="" [file=""] class="" @&gt;
&lt;html:placeholder name="Content" /&gt;

&lt;html:template name="MyTemplate"&gt;
  &lt;template:placeholder name="MyPlaceHolder"&gt;
&lt;/html:template&gt;
</gen:highlight>
<strong>Controller:</strong>
<gen:highlight type="php">
class my_controller extends base_controller {
   public function transformContent(){
      $Template__MyTemplate = &$this->getTemplate('MyTemplate');
      $Template__MyTemplate->setPlaceHolder('MyPlaceHolder','MyContent');
      $this->setPlaceHolder('Content',$Template__MyTemplate->transformTemplate());
   }
}
</gen:highlight>
Here a document controller, a HTML place holder and a template with accompanying place holder is
defined in the template file. Now in the controller you can get a reference on the template by using
the <em>getTemplate()</em> methode and fill it with <em>setPlaceHolder()</em>.
Afterwards the template is transformed and the output is used to fill the HTML place holder by means
of <em>setPlaceHolder()</em>. It is possible to define several templates inside a template file.
Often this is used for the issue of displaying different announcements with different events.
<br />
<br />
<br />
<h5 id="Chapter-2-3-2-Template-enhancement"><a href="#Chapter-2-3-2-Template-enhancement">2.3.2. Template enhancement</a></h5>
If the standard functionality of HTML templates must be extended, the tag "&lt;template:addtaglib /&gt;"
can be used to achieve this goal. The behavour of the is similar to "&lt;core:addtaglib /&gt;" that
can be used in context of template files to add tag libs there.
<gen:highlight type="apf-xml">
&lt;template:addtaglib namespace="" prefix="" class="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path seperated with "::".
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML prefix
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML class
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
</ul>
<p>
   An example of the use of the XML tag is the taglib tag &lt;[html|template]:getstring / &gt;
   to read a string from a configuration file and display it. See chapter 2.2.3 or 2.4 for more details.
</p>

<h5 id="Chapter-2-3-3-Getstring"><a href="#Chapter-2-3-3-Getstring">2.3.3. Getstring</a></h5>
<p>
   The tag <em>&lt;template:getstring /&gt;</em> gives the opportunity to read a configuration string from a
   language-dependent configuration file and so create multi-language GUIs.
</p>
<gen:highlight type="apf-xml">
&lt;template:getstring namespace="" config="" entry="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name of the configuration key.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>
<div class="hint">
   <p>
      To use the tag with APF releases &lt; 1.15 it must be announced using the
   </p>
<gen:highlight type="apf-xml">
&lt;template:addtaglib
   namespace="tools::html::taglib"
   prefix="template"
   class="getstring"
/&gt;
</gen:highlight>
   <p>
      directive.
   </p>
</div>
      
<h3 id="Chapter-3-Document"><a href="#Chapter-3-Document">3. Document</a></h3>
<h4 id="Chapter-3-1-Createobject"><a href="#Chapter-3-1-Createobject">3.1. createobject</a></h4>
This tag enables the developer to create a website with language-dependent content view based on
html files, that contain the content and functionality of the content pages. Content files are
expected to reside in a folder <strong>./frontend/content/</strong> in parallel to the current
bootstrap file (<em>index.php</em>). As an example this documentation page is based on this concept.
Content diles must be named like
<gen:highlight type="code">
c_{LANGCODE}_{NAME}.html
</gen:highlight>
whereas
<ul>
  <li><strong>LANGCODE</strong> is a 2 letter ISO language code (de, en, it, es, ...) and</li>
  <li><strong>NAME</strong> is the URL name of the current page.</li>
</ul>
<gen:highlight type="apf-xml">
&lt;doc:createobject requestparam="" defaultvalue="" /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>requestparam</strong>: URL parameter, that describes, which content fil has to be loaded.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9]</code>)
  </li>
  <li>
    <strong>defaultvalue</strong>: Default value of the parameter defined through <em>requestparam</em>.
  </li>
</ul>
To use the tag it must be announced using the
<gen:highlight type="apf-xml">
&lt;core:addtaglib namespace="tools::html::taglib" prefix="doc" class="createobject" /&gt;
</gen:highlight>
directive.
<br />
<br />
<div class="hint">
   If the tag could not find an appropriate file according to the <strong>requestparam</strong>, it
   expects a file with the name <gen:highlight type="code">c_{LANGCODE}_404.html</gen:highlight>
   to indicate, that the desired page cannot be displayed. In case the error file is not present a 
   php error will be displayed.
</div>

<h3 id="Chapter-4-Document-controller"><a href="#Chapter-4-Document-controller">4. Document controller</a></h3>
<p>
   As already described under <int:link pageid="006"/> a document controller must be declared via
</p>
<gen:highlight type="apf-xml">
&lt;@controller namespace="" [file=""] class="" @&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path to the controller.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>file</strong>: Name of the file, the controller resides in.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>class</strong>: Class name of the controllers.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
</ul>
<p>
   Any implementation must inherit from the abstract document controller <em>base_controller</em>. This
   class is defined in the <em>pagecontroller.php</em> file under <em>apps/core/pagecontroller</em> and
   must not be included separately.
</p>
<div class="hint">
   Since release 1.14 it is sufficient to specify a document controller using the <em>namespace</em> and
   <em>class</em> attribute. <em>file</em> is no more necessary.
</div>

<h3 id="Chapter-5-Front-controller"><a href="#Chapter-5-Front-controller">5. Front controller</a></h3>
Since release 1.4-18.11.2007 the tag "&lt;fcon:importdesign /&gt;" was added. It aids the implementation
of front controller based applications and makes it possible to include views by the use of application
model information according to the MVC pattern. Therefore a separate model class that provides the
information must be created for the entire application or a single module.
The control of the view integration is regulated typically by an own front controller actions that
is executed in "prepagecreate" mode (see <a href="./?Page=012-Frontcontroller" title="FrontController">FrontController</a>,
chapter 1.6). This action then can assign parameters to the model object that are contained in the
URL.
<gen:highlight type="apf-xml">
  &lt;fcon:importdesign
      templatenamespace=""
      modelnamespace=""
      modelfile=""
      modelclass=""
      modelparam=""
      [sessionsingleton=""]
  /&gt;
</gen:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>templatenamespace</strong>: Namespace path to the desired template folder.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>modelnamespace</strong>: Namespace path to the model class.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>modelfile</strong>: Class file of the model.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>modelclass</strong>: Class name of the model.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>modelparam</strong>: Model attribute that indicates the inclusion if the template file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>sessionsingleton</strong>: Defines, if the model object is created in SINGLETON or
    SESSIONSINGLETON mode. If the attribute is not present or contains any other value than
    <strong>true</strong>, the SINGLETON mode will be used.
    (<strong>Allowed values</strong>: <code>true|false</code>)
  </li>
</ul>
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="en_046" />