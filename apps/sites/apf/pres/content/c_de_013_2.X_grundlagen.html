<doku:title parent="119" tags="grundlagen,pattern,architektur,aufbau ordner struktur,templates,basis konfiguration,registry,dokumentation,framework" title="Grundlagen" urlname="Grundlagen">
   Das Kapitel Grundlagen beschreibt den Aufbau des APF, vermittelt Basis-Wissen und verweist auf für den Einstieg
   relevante Inhalte der Dokumentation.
</doku:title>
<h3 id="Chapter-1-Einfuehrung"><a href="#Chapter-1-Einfuehrung">1. Einführung</a></h3>
<p>
   Das Adventure PHP Framework (kurz: <em>APF</em>) versteht sich als Hilfsmittel für die Implementierung von
   objektorientierten, generischen und wiederverwendbaren PHP-Applikationen. Es implementiert eine Reihe von wichtigen,
   objektorientierten Design-Pattern und bietet umfassende Lösungen alltägliche Aufgabenstellungen an.
</p>
<p>
   Das APF ist <em>keine</em> fertige Anwendung, die lediglich konfiguriert werden muss, sondern eine Basis um solche
   Applikationen auf einfache Weise und unter Zuhilfenahme von Standard-Vorgehensweisen zu erstellen.
</p>

<h3 id="Chapter-2-Prinzipien-und-Paradigmen"><a href="#Chapter-2-Prinzipien-und-Paradigmen">2. Prinzipien und Paradigmen</a></h3>
<p>
   Wie andere PHP-Frameworks folgt auch das APF bestimmten Prinzipien und Paradigmen. Die folgende Liste zeigt die
   wichtigsten auf:
</p>
<ol>
   <li>
      <strong>Framework statt Klassen-Bibliothek</strong>:
      Das APF versteht sich als Framework und nicht als Klassen-Bibliothek. Es folgt festen Paradigmen folgt und gibt
      dem Entwickler verschiedene Vorgehensweisen an die Hand, die unveränderlich mit dem Framework verwoben sind.
      Diese - oft fälschlicherweise als Einschränkung empfundene - Tatsache hilft Applikationen nach erprobten Mustern
      zu erstellen und schützt Einsteiger vor Fehlern.
   </li>
   <li>
      <strong>Objekt-Orientierung</strong>:
      Die Komponenten des Adventure PHP Framework sind ausnahmslos nach dem objektorientierten Muster entworfen. Dies
      ermöglicht die Erstellung von gekapselten und wiederverwendbaren Funktionalitäten, die Lösungen für immer
      wiederkehrende Aufgabenstellungen bereit stellen.
   </li>
   <li>
      <strong>Design-Pattern</strong>:
      Die Implementierung der Komponenten des APF orientiert sich an gängige Entwurfsmuster an um den Einstieg in das
      Framework zu erleichtern und gängige Begrifflichkeiten zu verwenden.
   </li>
   <li>
      <strong>Bootstrapping</strong>:
      Um Konfiguration und Implementierung zu erleichten arbeitet das APF mit einem einzigen Einstiegspunkt in Ihre
      Anwendung - der sogenannten Bootstrap-Datei. Diese (z.B. <em>index.php</em>) nimmt alle Anfragen entgegen und
      beantwortet diese wie vom Entwickler vorgesehen. Details hierzu können Sie beispielsweise unter
      <int:link pageid="014" /> oder <int:link pageid="111" /> nachlesen.
   </li>
   <li>
      <strong>Trennung von Code und Konfiguration</strong>:
      Die Trennung von Applikationslogik und Konfiguration ermöglicht es Ihnen, wiederverwendbare Komponenten und Module
      zu erstellen. Nutzen Sie diese Möglichkeit, so lassen sich auf einfache Weise mehrere Projekte auf der selben
      Code-Basis aufsetzen bzw. eine Multi-Projekt Hosting-Umgebungen basierend auf nur einer APF-Installation aufbauen.
      Details hierzu erfahren Sie unter <int:link pageid="134" />.
   </li>
   <li>
      <strong>Offen für Weiterentwicklung</strong>:
      Das APF folgt dem <em>open close principle</em>. Es stellt verschiedene Erweiterungspunkte zur Verfügung, lässt sich
      jedoch nicht in seinen Grundfesten veränden. Die definierten <em>extension points</em> lassen jedoch nutzen, um
      auch exotische Anforderungen umzusetzen bzw. die im Framework enthaltenen Komponenten gemäß den Projekt-Anforderungen
      zu erweitern.
   </li>
   <li>
      <strong>Open Source</strong>:
      Das Adventure PHP Framework ist ein Open Source Produkt! Möchten Sie sich an der Weiterentwicklung beteiligen,
      werden Sie ein Teil des <int:link pageid="149" />s und nehmen Sie mit uns <int:link pageid="034" /> auf oder
      verfassen eine Beitrag im <a class="forum" href="http://forum.adventure-php-framework/">Forum</a>. Wir freuen uns
      auf Sie!
   </li>
</ol>

<!--
   Was noch zu erklären ist:
      - Context/Environment (wozu?)
      - Alles per Namespace addressieren (PHP-style)
      -


-->
<h3 id="Chapter-3-Das-1-x-1-des-APF"><a href="#Chapter-3-Das-1-x-1-des-APF">3. Das 1 x 1 des APF</a></h3>
<!--
   ==> Englisch The APF 101
-->
<p>
   In den folgenden Kapiteln können Sie grundsätzliche Dinge über das APF nachlesen.
</p>

<h4 id="Chapter-3-1-Was-brauche-ich-fuer-den-Start"><a href="#Chapter-3-1-Was-brauche-ich-fuer-den-Start">3.1. Was brauche ich für den Start?</a></h4>
<p>
   Das Adventure PHP Framework ist ein für <a class="external" href="http://www.php.net">PHP</a> geschriebenes Framework
   für die Entwicklung von Web-Applikationen. Aus diesem Grund benötigen Sie einen Web-Server der über ein PHP-Modul
   verfügt. Hierzu eignen sich sowohl der de-facto Standard <a class="external" href="http://httpd.apache.org">Apache HTTP Server</a>
   als auch beispielsweise <a class="external" href="http://nginx.org/en/docs/">ngnix</a>.
</p>
<p>
   Das APF 2.X setzt eine PHP-Version > 5.3.0 voraus, da es im Vergleich zur 1.X-Reihe PHP-Namespaces nutzt. Gängige
   Pakete wie beispielsweise <a class="external" href="http://www.apachefriends.org/de/xampp.html">XAMPP</a> verfügen
   in den aktuellen Versionen bereits über die notwendige PHP-Version.
</p>
<p>
   Um direkt mit dem Framework loszulegen wird empfohlen, eine <em>apf-demopack-*</em>-Datei herunter zu laden. Diese
   beinhaltet nicht nur den Code des APF, sondern auch eine fertige und ohne Anpassungen lauffähige Beispielwebseite -
   die <int:link pageid="074" />. Die Sandbox beinhaltet eine Reihe von Beispielen und Wizzards um sich mit dem APF
   anzufreunden. Sollten Sie noch keine Erfahrung mit der Entwicklung mit dem APF besitzten, so eignet sich die Sandbox
   ebenfalls als Start für die Entwicklung von eigenen Modulen oder Komponenten. Diese können Sie später natürlich ohne
   weiteres in Ihrer eigenen Webseite einsetzen.
</p>
<p>
   Um möglichst effektiv zu entwickeln empfiehlt das APF-Team den Einsatz von <a class="external" href="http://www.jetbrains.com/phpstorm/">PHPStorm</a>.
   Die IDE von JetBrains unterstützt Sie mit Code-Completion, direktem Feedback bei Code-Fehlern und einer Integration
   von <a class="external" href="http://xdebug.org/docs/remote">xdebug</a> zur Fehleranalyse Ihrer Anwendung.
</p>
<p>
   Mit den beschrieben Dingen sind Sie nun bestens gerüstet um mit der Entwicklung zu beginnen!
</p>

<h4 id="Chapter-3-2-Wo-finde-ich-die-wichtigsten-Ressourcen"><a href="#Chapter-3-2-Wo-finde-ich-die-wichtigsten-Ressourcen">3.2. Wo finde ich die wichtigsten Ressourcen?</a></h4>
<!--
Wie finde ich mich zurecht? Welche Resourcen sollte ich kennen?
   - Downloads
   - Doku
   - Forum
   - FAQs
   - Tutorials
   - Wiki

-->
<p>
   Die Seite des Adventure PHP Frameworks ist in zwei große Bereiche aufgeteilt: der <int:link pageid="008" />-Bereich
   und die <int:link pageid="072" />.
</p>
<p>
   Im Bereich <int:link pageid="008" /> finden Sie jeweils die Downloads des aktuellen Release und einen Verweis auf
   ältere Versionen (siehe <int:link pageid="123" />). Suchen Sie nach der aktuell in der Entwicklung befindlichen Version,
   so finden Sie diese unter <int:link pageid="068" /> zusammen mit einem Verweis auf einen aktuellen Snapshot.
</p>
<p>
   Die Dokumentation zum Framework finden Sie unter <int:link pageid="072" />. Dort finden Sie wiederum folgende
   Bereiche: der <int:link pageid="119" /> mit jeweils einem Kapitel zur jeder Komponente, dem Bereich
   <int:link pageid="071" /> und der Sektion <int:link pageid="100" /> in dem Sie weiterführendes zum Framework und
   zur Software-Entwicklung nachlesen können.
</p>
<p>
   Zusätzlich stehen Ihnen noch das <a class="forum" href="http://forum.adventure-php-framework.org">Forum</a> und das
   <a class="wiki" href="http://wiki.adventure-php-framework.org/de/Hauptseite">Wiki</a> zur Verfügung.
</p>

<h4 id="Chapter-3-3-Welche-Komponenten-besitzt-das-APF"><a href="#Chapter-3-3-Welche-Komponenten-besitzt-das-APF">3.3. Welche Komponenten besitzt das APF?</a></h4>
<p>
   Das Adventure PHP Framework besteht im Wesentlichen aus vier Bereichen: dem <em>core</em> in dem die Basis-Komponenten
   beheimatet sind, den <em>tools</em> die für die Entwicklung nützliche Komponenten mitliefern und den <em>modules</em>
   und <em>extensions</em>, die für den Einsatz fertige Module oder Erweiterungen enthalten.
</p>
<p>
   Ein Release besteht typischerweise aus mehreren Pakete, die jedoch alle auf dem <em>apf-codepack-*</em> aufbauen, das
   die Code-Basis beinhaltet. Neben diesem finden Sie <em>apf-configpack-*</em>-Dateien in der Liste der
   <int:link pageid="008" />, das einen Satz an Beispiel-Konfigurationen pro Version ausliefert.
</p>
<p>
   Suchen Sie für Ihren Einstieg nach Beispiel-Code, so können Sie sich die <int:link pageid="074" /> (Paket:
   <em>apf-demopack-*</em>) oder die Beispiel-Pakete <em>apf-calc-example-*</em> (Taschenrechner), <em>apf-modules-example-*</em>
   (Einbindung von dynamischen Modulen) oder <em>apf-vbc-example-*</em> - eine Beispiel-Implementierung für
   <int:link pageid="086" /> - herunterladen.
</p>

<h3 id="Chapter-4-Ordner-Struktur"><a href="#Chapter-4-Ordner-Struktur">4. Ordner-Struktur</a></h3>
<p>
   Wie in <a href="#Chapter-3-1-Was-brauche-ich-fuer-den-Start">Kapitel 3</a> aufgeführt beinhaltet das
   <em>apf-codepack-*</em> die Code-Basis des Adventure PHP Framework. Das Paket ist wie folgt aufgebaut:
</p>
<gen:highlight type="code">
APF/
    core/
    extensions/
    modules/
    tools/
</gen:highlight>
<p>
   Die Ordner <em>core</em> und <em>tools</em> beinhalten die Kern-Bestandteile des Frameworks. In <em>core</em>
   befindet sich u.a. die Implementierung von <int:link pageid="098" /> (<em>/APF/core/pagecontroller/</em>) und
   <int:link pageid="012" /> (<em>/APF/core/frontcontroller/</em>), in <em>tools</em> u.a. die Implementierung der
   <int:link pageid="113" /> (<em>/APF/tools/form/</em>).
</p>
<p>
   Der Ordner <em>modules</em> beinhaltet Module, die auf den <em>core</em>- und <em>tools</em>-Komponenten aufsetzen.
   Dazu zählen u.a. die <int:link pageid="089" /> und das <int:link pageid="095" />, die in von Ihnen implementierte
   Webseiten oder Web-Applikation eingebaut werden können.
</p>
<p>
   Details zu dein einzelnen Komponenten finden Sie auch in der <int:link pageid="002" />.
</p>

<h3 id="Chapter-5-Aufbau-einer-einfachen-Applikation"><a href="#Chapter-5-Aufbau-einer-einfachen-Applikation">5. Aufbau einer einfachen Applikation</a></h3>
<p>
   Das vorliegende Kapitel zeigt Ihnen, wie Sie ausgehend von einem <em>apf-codepack-*</em>-Release vorgehen um eine
   einfache Seite aufzubauen.
</p>
<div class="hint">
   Weitere Inhalte zum Einstieg in das APF und zum Aufbau einer einfachen Webseite finden Sie auch unter
   <int:link pageid="014" />, <int:link pageid="111" /> oder <int:link pageid="048" />. Weitere Tutorials sind auf der
   Seite <int:link pageid="071" /> aufgelistet.
</div>

<h4 id="Chapter-5-1-Aufbau-der-Bootstrap-Datei"><a href="#Chapter-5-1-Aufbau-der-Bootstrap-Datei">5.1. Aufbau der Bootstrap-Datei</a></h4>
<p>
   Wie in <a href="#Chapter-2-Prinzipien-und-Paradigmen">Kapitel </a> beschrieben, setzt das APF das
   <em>Bootstrapping</em>-Konzept ein. Dies bedeutet, dass alle Anfragen Ihrer Besucher über eine zentrale Datei
   (meist <em>index.php</em>, da diese im Webserver als <em>DirectoryIndex</em> konfiguriert ist) verarbeitet werden.
</p>
<p>
   Um eine einfache Applikation zu erstellen laden Sie sich bitte ein <em>apf-codepack-*</em>-Release herunter und
   entpacken dieses in einem Ordner Ihrer Wahl unterhalb des <em>DOCUMENT_ROOT</em> des Web-Servers. Anschließend
   erstellen Sie bitte die Datei <em>index.php</em> parallel zum <em>APF</em>-Ordner.
</p>
<p>
   Um eine einfache Applikation bzw. Webseite zu erstellen starten Sie mit einem initialen Template, das dann die
   unterschiedliche Bereiche Ihrer Applikation aufnimmt. Als Ausgangspunkt können Sie folgenden Inhalt für Ihre
   <em>index.php</em> nutzen:
</p>
<gen:highlight type="php">
include('./APF/core/bootstrap.php');

use APF\core\singleton\Singleton;
use APF\core\frontcontroller\Frontcontroller;
$fC = &Singleton::getInstance('APF\core\frontcontroller\Frontcontroller');

echo $fC->start('APF\site\templates', 'main');
</gen:highlight>
<p>
   In der ersten Zeile wird die Datei <em>APF/core/bootstrap.php</em> eingebunden. Diese bindet die notwendigen
   APF-Komponenten ein und konfiguriert diese initial.
</p>
<p>
   Zeile 5 erstellt eine Instanz des <int:link pageid="012" /> und in der letzten Zeile wird die Request-Verarbeitung
   unter Angabe des initialen Template gestartet. Das <em>echo</em> bewirkt, dass die Rückgabe - also die generierte
   Seite - an den Benutzer zurückgegeben wird.
</p>
<!--
   Work status marker...
-->
<div class="hint">
   Hinweise zu Konfigurationsmöglichkeiten in der index.php finden sich unter

   - Konfiguration
   - Input/Output Filter
   - URL-Rewriting
   - Logger
   - ...
</div>

<h4 id="Chapter-3-2-Aufbau-Basistemplate"><a href="#Chapter-3-2-Aufbau-Basistemplate">3.2. Aufbau des Basis-Templates</a></h4>
<p>
   Templates spielen im Adventure PHP Framework eine entscheidende Rolle. Abstrakter betrachtet ist
   dabei ein Baum-Knoten einer Webseite eine kleine MVC-Einheit, die aus einem Model (zumeist dem Model der
   Applikation oder Webseite), dem View(-Template), einem XML-/HTML-Template, und einem Controller
   (Document-Controller), falls erwünscht, besteht. Den Kern des Frameworks stellt der Page-Controller
   dar, der aus einem Template einen Objektbaum erzeugt und dafür sorgt, dass bei der Transformation
   die entsprechenden Controller ausgeführt werden.
</p>
<p>
   Mit der Gestaltung der Templates definiert der Entwickler quasi die Komplexität der Seite und
   den Aufbau des Objektbaums. In der <strong>index.php</strong> wird mit der Methode
   <strong>loadDesign()</strong> ein initiales Template einer Applikation oder eines Modules geladen,
   das die oberste Ebene des Aufbaus der Seite definiert. Jedes eingebundene Template bildet dabei einen
   Kind des aktuellen Baum-Knotens. Die Verschachtelungstiefe ist dabei nicht beschränkt. Die
   folgende Codebox zeigt ein einfaches Template, das als Layout einer Webseite dienen kann:
</p>
<gen:highlight type="html">
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;...&lt;/title&gt;
  &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;/head&gt;
&lt;body&gt;
...
&lt;/body&gt;
&lt;/html&gt;
</gen:highlight>
<p>
   Weiterführende Beispiele zu Templates können den Kapiteln <int:link pageid="014"/> und
   <int:link pageid="047"/> entnommen werden, das Tutorial <int:link pageid="048"/> gibt eine
   weitere Einführung in das Erstellen von Web-Seiten und -Applikationen.
</p>

<h4 id="Chapter-3-3-Basiskonfiguration"><a href="#Chapter-3-3-Basiskonfiguration">3.3. Basis-Konfiguration</a></h4>
<p>
   Im Gegensatz zu früheren Versionen (&lt; 1.7) benötigt das Framework zunächst keine
   weitere Konfiguration. Intern werden jedoch einige Basis-Konfigurationsparameter im Namespace
   <strong>apf::core</strong> der <int:link pageid="067"/> verwaltet. Müssen diese für den
   speziellen Anwendungsfall angepasst werden, so kann das in der Boostrap-Datei wie nachfolgend
   dargestellt bewerkstelligt werden. Die Registry dient nicht nur als zentraler Informationspool für
   das Framework, sondern kann auch für die Steuerung von konkreten Anwendungen eingesetzt werden.
</p>
<gen:highlight type="php">
// Page-Controller einbinden (APF-Core-Library)
include_once('./apps/core/pagecontroller/pagecontroller.php');

// Front-Controller einbinden
import('core::frontcontroller', 'Frontcontroller');

// Umgebungsvariable manipulieren
Registry::register('apf::core','Environment','MY_ENV');

// Basis-Pfad der Applikation manipulieren
Registry::register('apf::core','URLBasePath','http://mybaseurl.de');

// URLRewriting-Modus ändern (true: URL wird mit / dargestellt, false: "normale" URLs)
Registry::register('apf::core','URLRewriting',true);

// Log-Verzeichnis anpassen
Registry::register('apf::core','LogDir','/Pfad/zu/meinem/Log/Verzeichnis');

// Front-Controller erzeugen und konfigurieren
$fC = &Singleton::getInstance('Frontcontroller');
$fC->setContext('{1}');
// optional: $fC->setLanguage('{2}');

// Request-Abarbeitung starten und Ergebnis zum Client senden
echo $fC->start('{3}', '{4}');
</gen:highlight>
<p>
   Die aufgeführten Parameter der <int:link pageid="067" /> haben folgende Bedeutung:
</p>

<h5 id="Chapter-3-3-1"><a href="#Chapter-3-3-1-Environment">3.3.1. Environment</a></h5>
<p>
   <strong>Verwendet von:</strong> ConfigurationManager, MySQLxHandler, MySQLHandler, SQLiteHandler, ...
</p>
<p>
   Jede Konfigurations-Datei besteht aus vier unterschiedlichen Bestandteilen:
</p>
<ul>
   <li>Namespace: Ordner, unterhalb dem alle Konfigurationsdateien dieser Anwendung liegen</li>
   <li>Context: Aktueller Context der Applikation</li>
   <li>Umgebung: z.B. für Entwicklung, Test und Live</li>
   <li>Dateinamen: Dateiname der Konfigurationsdatei</li>
</ul>
<p>
   Diese Abstraktion wurde eingeführt, damit eine Anwendung oder ein Modul in unterschiedliche
   andere Anwendungen oder Module eingebunden werden kann und auf unterschiedlichen Systemen zur
   gleichen Zeit ohne Änderung des Quellcodes lauffähig ist. Für das Laden von
   Konfigurationen gibt es jedoch standardisierte Methoden, so dass sich der Programmierer darum nicht
   mehr kümmern muss. Weiterführendes dazu kann im Kapitel <int:link pageid="134" />
   nachgelesen werden.
</p>
<p>
   <strong>Standard-Wert:</strong> &quot;DEFAULT&quot;
</p>

<h5 id="Chapter-3-3-2-URLBasePath"><a href="#Chapter-3-3-2-URLBasePath">3.3.2. URLBasePath</a></h5>
<p>
   <strong>Verwendet von:</strong> AdvancedBBCodeParser, SocialBookmarkManager, ...
</p>
<p>
   Viele Module verlinken auf sich selbst oder ander Bereiche eines Moduls oder einer Webseite. Aus
   diesem Grund muss bekannt sein, wie die Basis-URL der Seite lautet. Der Registry-Wert
   URLBasePath definiert diese.
</p>
<p>
   <strong>Standard-Wert:</strong> &quot;HTTP_HOST-Wert des $_SERVER-Arrays&quot;
</p>

<h5 id="Chapter-3-3-3-URLRewriting"><a href="#Chapter-3-3-3-URLRewriting">3.3.3. URLRewriting</a></h5>
<p>
   <strong>Verwendet von:</strong> ChainedGenericInputFilter, ChainedGenericOutputFilter, LinkGenerator, ...
</p>
<p>
   Die mit dem APF ausgelieferten <int:link pageid="137" /> und der 
   <int:link pageid="138">LinkGenerator</int:link> unterstützen URL-Rewriting. Unter URL-Rewriting
   versteht sich die Verwendung von URLs der Form <em>http://www.domain.tld/param1/value1/param2/value2</em>
   statt <em>http://www.domain.tld?param1=value1&amp;param2=value2</em>. Ist der Wert auf &quot;true&quot;
   gesetzt, so werden die mit dem <int:link pageid="138">LinkGenerator</int:link> generierten Links
   in der umgeschriebenen Form ausgegeben.
</p>
<p>
   Details können dem Kapitel <int:link pageid="069" /> bzw. <int:link pageid="137" /> und
   <int:link pageid="138" /> entnommen werden.
</p>
<p>
   <strong>Standard-Wert:</strong> &quot;false&quot;
</p>

<h5 id="Chapter-3-3-4-LogDir"><a href="#Chapter-3-3-4-LogDir">3.3.4. LogDir</a></h5>
<p>
   <strong>Verwendet von:</strong> Logger, ...
</p>
<p>
   Um zentrales Logging zu ermöglichen, muss der Pfad, in den Log-Dateien geschreiben werden
   zentral bekannt gegeben werden. Der Pfad wird von der Klasse <strong>Logger</strong> verwendet.
</p>
<p>
   <strong>Standard-Wert:</strong> &quot;./logs&quot;
</p>

<h5 id="Chapter-3-3-5-LibPath"><a href="#Chapter-3-3-5-LibPath">3.3.5. LibPath</a></h5>
<p>
   <strong>Verwendet von:</strong> div. Extensions, ...
</p>
<p>
   Die Direktive <strong>LibPath</strong> speichert den Basis-Pfad, in dem die Programmdateien
   abgelegt wurden. Der Pfad wird dynamisch gesetzt und ist nur für den lesenden Zugriff
   freigegeben.
</p>

<core:importdesign namespace="APF\modules\comments\pres\templates" template="comment" categorykey="de_013" />