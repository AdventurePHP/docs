<doku:title tags="form,taglib,validatoren,validator,filter,auto,ausfuellen,presetting,1.11" title="Forms (as of release 1.11)" urlname="Forms">
   Das APF bietet auf Basis von Taglibs eine komplette Abstraktion von Formularen und
   Formular-Elementen. Diese beherrschen out-of-the-box Presetting (Auto-Ausf&uuml;llen), Validierung
   und Filterung. Im Document-Controller steht ein Formular als eigenst&auml;ndiges Objekt mit diversen
   Funktionen zur Verf&uuml;gung.
</doku:title>
<a name="1-Introduction"></a><h3>1. Introduction</h3>
Due to the fact, that the
<a href="./?Seite=098-Pagecontroller" title="Page controller">page controller</a> of the APF
provides a generic frame to handle taglibs, we were able to implement a form abstraction built on
taglibs (e.g. text fields).
<br />
<br />
The release of the adventure php framework contains a set of taglibs, that fully describe HTML
forms and that contain features such as filtering, validation and presetting at the same time out of
the box. With the taglibs reworked with release 1.11, form fields can be applied various filters and
validators and custom form elements can be integrated with the delivered ones.
<br />
<br />
The subsequent chapters describe the general design and the handling of APF forms as well as the
tags shipped with the release with their meaning and functionality. Reading this documentation
and implementing applications, it is recommended to have the
<a href="./?Page=002-API-documentation" title="API documentation">API documentation</a> opened.
There, you can see, which functionality is included in the various taglibs - e.g. the
<strong>html_taglib_form</strong>.
<br />
<br />
<div class="hint">
   Chapter <a href="./?Page=114-Usage-of-forms" title="Usage of forms">usage of forms</a> contains
   extended examples on form usage and extension of APF forms.
</div>
<br />
<a name="2-Construction"></a><h3>2. Construction of forms</h3>
As noted in the introduction, APF forms are represented by taglibs. The
<strong>&lt;html:form /&gt;</strong> tag forms the base taglib, that encapsulates all other form
tags and presents an APF form <u>as a single</u> object to the document controller. It contains
further tag instances as it's child oblects that represent dedicated elements like text fields or
buttons or functional tags such as place holders, listeners or tags, that add custom form controls.
<br />
<br />
Forms - as you know from other APF GUI elements - are defines within template files. A simple form
with a search field and a button looks like this:
<code:highlight>
&lt;core:addtaglib namespace="tools::form::taglib" prefix="html" class="form" /&gt;
&lt;html:form name="Search"&gt;
   &lt;form:text name="searchterm" /&gt; &lt;form:button name="search" value="GO" /&gt;
&lt;/html:form&gt;
</code:highlight>
In order to display the form a document controller must be defined for the corresponding template.
This is necessary, because a form - in contrast to other tags - is always coupled with functionality
to handle the data passed to the form. This may be reading the search term or executing the search
or saving user data.
<br />
<br />
Displaying a form is not rocket science with the APF and can be done with the following controller
code:
<php:highlight>
class search_controller extends baseController {
   public function transformContent(){
      $form = &$this->__getForm('Search');
      $form->transfromOnPlace();
   }
}
</php:highlight>
The subsequent sections present the form controls contained within the APF release and give you
a brief introduction to the usage of these elements.
<br />
<br />
<br />
<a name="3-Shipped-tags"></a><h3>3. Shipped tags</h3>
The APF contains an extended set of form control abstraction tags, that can be configured for
different purposes. In case this is not enough, custom form taglibs can be introduced as desired.
This is described in detail under
<a href="./?Page=114-Form-usage" title="Usage of forms">usage of forms</a>.
<br />
<br />
Since the APF's page controller is built up on a generic tag parser, form tags can be added
generic attributes such as:
<ul>
   <li><strong>id="..."</strong></li>
   <li><strong>class="..."</strong></li>
   <li><strong>style="..."</strong></li>
</ul>
These are presented in the generated source code and can thus be used for formatting purposes. For
this reason, the following chapters do not mention these attributes, but only describe the
attributes, that are necessary for the configuration of the tag.
<br />
<br />
<div class="hint">
   Attributes, that are surrounded with &quot;[&quot; and &quot;]&quot; (brackets) are optional.
   All other attributes must be present, otherwise the corresponding taglib may throw an error.
</div>
<br />
The form tag itself takes three functional atributes, that are used for definition and configuration:
<code:highlight>
&lt;html:form name="" [method=""] [action=""]&gt;
  ...
&lt;/html:form&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the form. This attribute is used to address the form within
    a document controller.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>method</strong>: Method that is used to send the form data. By default,
    <strong>post</strong> is used.
    (<strong>Allowed characters</strong>: <code>[get|post]</code>)
  </li>
  <li>
    <strong>action</strong>: The url, that is called on button click by the browser.
  </li>
</ul>
<br />
<a name="3-1-Button"></a><h4>3.1. Button</h4>
This taglib represents a submit button. APF form elements are validated and filtered on button click
event. Hence, it is necessary to specify a button or image button within the form, due buttons
create the <em>click event</em>.
<code:highlight>
&lt;form:button name="" value="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the button. The name is used to access the button. This is
    necessary for validators and filters.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the button. The browser uses this value to label the button.
  </li>
</ul>
<br />
<a name="3-2-Image-button"></a><h4>3.2. Image button</h4>
The image button tag creates an image button, that uses an image as the label. The functionality
is equal to the &quot;normal&quot; button.
<code:highlight>
&lt;form:imagebutton name="" src="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the button. The name is used to access the button. This is
    necessary for validators and filters.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>src</strong>: Image source.
  </li>
</ul>
<br />
<a name="3-3-Reset"></a><h4>3.3. Reset button</h4>
As of the release 1.10, the form taglibs contain a reset button wrapper. It represents a HTML reset
button and can be addressed and configured as &quot;normal&quot; buttons within a document
controller.
<br />
<br />
<div class="hint">
   A reset button does not fire the click event, thus validation and filtering is not possible!
</div>
<code:highlight>
&lt;form:reset value="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>value</strong>: The value (label) of the reset button.
  </li>
</ul>
<br />
<a name="3-4-Hidden"></a><h4>3.4. Hidden field</h4>
<code:highlight>
&lt;form:hidden name="" value="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: The name of the hidden field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: The value of the hidden field.
  </li>
</ul>
<br />
<a name="3-5-Text"></a><h4>3.5. Text field</h4>
<code:highlight>
&lt;form:text name="" [value=""] /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the text fields. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of te text field.
  </li>
</ul>
<br />
<a name="3-6-Text-area"></a><h4>3.6. Text area</h4>
You can use the APF text area wrapper taglib in two flavours: without explicit content as a
self-closing tag and with content as explicitly closing tag.
<code:highlight>
&lt;form:area name="" /&gt;
&lt;form:area name=""&gt;...&lt;/form:area&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the text area. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<br />
<a name="3-7-Password"></a><h4>3.7. Password field</h4>
<code:highlight>
&lt;form:password name="" [value=""]/&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the password field. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the password field.
  </li>
</ul>
<br />
<a name="3-8-File-upload-field"></a><h4>3.8. File upload field</h4>
<code:highlight>
&lt;form:file name="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the file upload field. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
<br />
<a name="3-9-Checkbox"></a><h4>3.9. Checkbox</h4>
The checkbox implementation is not only a simple wrapper for the HTML checkbox, but includes the
functionality to automatically check or uncheck the box. With this taglib, the problem with
re-checking boxes on re-submit is solved.
<code:highlight>
&lt;form:checkbox name="" value="" [checked="checked"] /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the checkbox. This attribute can be used to access the
    control. (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the checkbox.
  </li>
  <li>
    <strong>checked</strong>: Defines, whether the checkbox should be preselected.
  </li>
</ul>
<br />
<a name="3-10-Radio-button"></a><h4>3.10. Radio button</h4>
The radio button implementation is not only a simple wrapper for the HTML radio buttons, but
includes the functionality to automatically check or uncheck the button. With this taglib, the
problem with re-checking buttons on re-submit is solved.
<code:highlight>
&lt;form:radio name="" value="" [checked="checked"]/&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the radio button. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the radio button - or precisely - the name of the current option.
  </li>
  <li>
    <strong>checked</strong>: Defines, whether the button should be preselected.
  </li>
</ul>
<br />
<a name="3-11-Select"></a><h4>3.11. Select field</h4>
A select field can be defined in two different ways. Possibility one is a field, that is filled
dynamically within a document controller and does not contain static options. Possibility two is a
select field, that defines static options that may be preselected.
<code:highlight>
&lt;form:select name="" /&gt;
&lt;form:select name=""&gt;
  &lt;select:option value="" [selected="selected"]&gt;...&lt;/select:option&gt;
&lt;/form:select&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the select field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the option.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>selected</strong>: In case an option should be preselected, the <em>selected</em>
    attribute must contain the name of the attribute as it's value.
  </li>
</ul>
<br />
<a name="3-12-Multi-select"></a><h4>3.12. Multi select field</h4>
As the simple select field, the multi select field allows you to specify two different types: with
and without static options.
<code:highlight>
&lt;form:multiselect name="" /&gt;
&lt;form:multiselect name=""&gt;
  &lt;select:option value="" [selected="selected"]&gt;&lt;/select:option&gt;
&lt;/form:multiselect&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the multi select field. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>value</strong>: Value of the option.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>selected</strong>: In case an option should be preselected, the <em>selected</em>
    attribute must contain the name of the attribute as it's value.
  </li>
</ul>
<br />
<div class="hint">
   The name of the form field must not contain &quot;[]&quot; at the end. Otherwise errors occure
   when addressing the element!
</div>
<br />
<br />
<a name="3-13-Place-holder"></a><h4>3.13. Place holder</h4>
A place holder can be used to insert dynamic content into the form.
<code:highlight>
&lt;form:placeholder name="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the place holder. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
</ul>
Filling a place holder, the <strong>html_taglib_form</strong>'s method
<strong>setPlaceHolder()</strong> can be uses:
<php:highlight>
$form = &$this->__getForm('MyForm');
$form->setPlaceHolder('NameOfThePlaceHolder','...Value...');
</php:highlight>
<br />
<a name="3-14-Date-control"></a><h4>3.14. Date control</h4>
To ease date select field generation, the APF contains a date form control that can be configured
to fit your needs.
<code:highlight>
&lt;form:date name="" [yearrange=""] [offsetnames=""]/&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the date control. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>yearrange</strong>: The range of years, that should be presented to the user.
    Example: <code>1990-2007</code>.
    (<strong>Allowed characters</strong>: <code>[0-9-]</code>)
  </li>
  <li>
    <strong>offsetnames</strong>: Explicitly specifies the name of the date control's components
    (=name of the single fields). Example: <code>day;month;year</code>.
    (<strong>Allowed characters</strong>: <code>[A-Za-z;]</code>)
  </li>
</ul>
<br />
<a name="3-15-Marker"></a><h4>3.15. Marker</h4>
As described in chapter
<a href="" title="Dynamic forms">dynamic forms</a>,
the <strong>&lt;form:marker /&gt;</strong> tag can be used to position dynamic form elements. The
tag itself creates no output.
<code:highlight>
&lt;form:marker name="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>name</strong>: Name of the markers. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
</ul>
<br />
<a name="3-16-Addtaglib"></a><h4>3.16. Addtaglib</h4>
The <strong>&lt;form:addtaglib /&gt;</strong> tag is the pendant to the
<strong>&lt;core:addtaglib /&gt;</strong> tag. It offers the possibbility to add custom form tags.
<code:highlight>
&lt;form:addtaglib namespace="" prefix="" class="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace path seperated with "::".
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>prefix</strong>: XML prefix
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
  <li>
    <strong>class</strong>: XML class
    (<strong>Allowed characters</strong>: <code>[a-z]</code>)
  </li>
</ul>
<div class="hint">
   Please note, that the taglibs added with this tag implement the <strong>form_control</strong>
   class to ensure, that the correct status is reported to the form by isSent() and isValid().
</div>
<br />
<a name="3-17-Getstring"></a><h4>3.17. Getstring</h4>
The <strong>&lt;form:getstring /&gt;</strong> tag offers the possibility to display language
dependent values from a language dependent config file within forms. Details on the configuration
can be read about in the chapter, that describes the
<a href="./?Page=046-Standard-taglibs#2-2-Getstring" title="html:getstring">&lt;html:getstring /&gt;</a>
tag.
<code:highlight>
&lt;form:getstring namespace="" config="" entry="" /&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-:]</code>)
  </li>
  <li>
    <strong>config</strong>: Name of the configuration file.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>entry</strong>: Name of the configuration key to display the value of.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_.]</code>)
  </li>
</ul>
<br />
<a name="3-18-Listener"></a><h4>3.18. Listener</h4>
The listener tag is part of the new validation concept. The tag &quot;listens&quot; on the event, the
validator fires and shows it's content, in case the addressed form element could not be validated
successfully. Within the body of the tag, several subtags and textual content can be defined, that
can be used to format the output. Details on the validation concept can be read about in chapter 4.
<code:highlight>
&lt;form:listener [name=""] control="..."&gt;
  ...
  [&lt;listener:getstring namespace="" config="" key="" /&gt;]
  [&lt;listener:placeholder name="" /&gt;]
  ...
&lt;/form:listener&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>control</strong>: Name of the form element, that the validator tag listens to.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
  <li>
    <strong>name</strong>: Name of the listener. This attribute can be used to access the
    control.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_-]</code>)
  </li>
</ul>
The place holder tag <strong>&lt;listener:placeholder /&gt;</strong> acts like the
<a href="./?Page=046-Standard-taglibs#2-1-Placeholder" title="html:placeholder tag">&lt;html:placeholder /&gt;</a>,
the <strong>&lt;listener:getstring /&gt;</strong> tag like the
<a href="./?Page=046-Standard-taglibs#2-2-Getstring" title="html:getstring tag">&lt;html:getstring /&gt;</a>
tag. In order to fill the the place holder, the following document controller code can be used:
<br />
<br />
<u>Template:</u>
<code:highlight>
&lt;html:form name="name_form" method="post"&gt;
   &lt;form:listener name="name-listener" control="name"&gt;
      Please fill in the &lt;listener:placeholder name="field-name" /&gt; field!
   &lt;/form:listener&gt;
   &lt;form:text name="name" /&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      control="name"
      button="send"
   /&gt;
   &lt;form:button name="send" value="Send" /&gt;
&lt;/html:form&gt;
</code:highlight>
<u>Controller:</u>
<php:highlight>
class form_controller extends baseController {
   public function transformContent(){
      $form = &$this->__getForm('name-form');
      $listener = &$form->getFormElementByName('name-listener');
      $listener->setPlaceHolder('field-name','name');
   }
}
</php:highlight>
<br />
<a name="3-19-Error"></a><h4>3.19. Display of form errors</h4>
The tag described within chapter 3.18 can be used to automatically display field relevant errors.
The <nobr><strong>&lt;form:error /&gt;</strong></nobr> tag is used to display errors for the matter
of the whole form. If one of the fields could not be validated successfully, the content of the tag
is displayed - if present in the form definition.
<code:highlight>
&lt;form:error [name=""]&gt;
  ...
  [&lt;error:getstring namespace="" config="" key="" /&gt;]
  [&lt;error:placeholder name="" /&gt;]
  ...
&lt;/form:error&gt;
</code:highlight>
The place holder tag <strong>&lt;error:placeholder /&gt;</strong> acts like the
<a href="./?Page=046-Standard-taglibs#2-1-Placeholder" title="html:placeholder tag">&lt;html:placeholder /&gt;</a>,
the <strong>&lt;error:getstring /&gt;</strong> tag like the
<a href="./?Page=046-Standard-taglibs#2-2-Getstring" title="html:getstring tag">&lt;html:getstring /&gt;</a>
tag. Filling the place holder can be done as described in the last chapter.
<br />
<br />
<br />
<a name="4-Validation"></a><h3>4. Validation</h3>
In the previous versions of the APF the validation was linked directly with a form element and
the validation was executed within the
<a href="./?Page=098-Pagecontroller#2-1-Activity-diagram" title="Taglib lifecycle of the page controller">lifecycle of the taglibs</a>.
This has the disadvantage, that one element can be defined with only one validator. This leads to
redundant code, because each field must have it's own validator defined. Furthermore, it was not
possible to implement own validators.
<br />
<br />
From version 1.11 these circumstances were considered and the form taglibs were moved to a new
variation of the validation. From this version validators are applied by an own tag, that follows
the <a href="http://en.wikipedia.org/wiki/Observer_pattern" title="Observer pattern" target="_blank">observer pattern</a>.
The tag itself then binds a validator to the desired form control. Thus it is possible to attach
several validators onto one field, to write own validators and to validate several fields with one
observer definition at the same time.
<br />
<br />
The definition of a validator now is as follows:
<code:highlight>
&lt;form:addvalidator
   namespace=""
   class=""
   button=""
   control=""
/&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the validator implementation.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>class</strong>: Name of the validator implementation (name = class name!)
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>button</strong>: Name of the button, that triggers the validation event. The validation
    is executed, when the <em>isSent</em> event is fired by a button or an image button.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>control</strong>: Name of the form control to validate. In case, multiple controls should
    be allocated the same validator by only one tag definition, the attribute can contain a
    pipe-separated list of form controls (e.g. <em>sender|recipient|subject</em>).
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_|]</code>)
  </li>
</ul>
<div class="hint">
   In case you are using shipped validators, the <strong>namespace</strong> attribute can be omitted.
   The taglib therefore uses <strong>tools::form::validator</strong> as the default value. Within
   this namespace, all validators described in chapter 4.1 are located there.
</div>
<br />
<br />
<a name="4-1-Shipped-validators"></a><h4>4.1. Shipped validators</h4>
As in previous releases, the APF shipps a couple of built-in validators. These usually cover the
large part of the demands. Should these not be enough, own validators can be implemented. This is
described in the next chapter.
<br />
<br />
Currently the following validators are available:
<br />
<br />
<br />
<a name="4-1-1-TextLengthValidator"></a><h5>4.1.1. TextLengthValidator</h5>
The <strong>TextLengthValidator</strong> checks a text form field (text field, password field,
text area) whether the contained text has a least length. By default, the text entered by the user
must have a least length of 3 characters, before the field is considered valid. Provided that
another text length is desired, the attribute <strong>minlength</strong> must be given in the
attribute list of the referenced text field:
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="firstname" /&gt;
   &lt;form:text name="lastname" minlength="5" /&gt;
   &lt;form:password name="pass" /&gt;
   &lt;form:area name="comment" minlength="20" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="TextLengthValidator"
      button="send"
      control="firstname|lastname|pass|comment"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
Within the code block the form control <strong>firstname</strong> is tested to contain at least >=3
characters, the <strong>lastname</strong> field must contain at least 5 characters to be valid.
<br />
<br />
<br />
<a name="4-1-2-NumberValidator"></a><h5>4.1.2. NumberValidator</h5>
The <strong>NumberValidator</strong> checks whether a text field contains a valid number. For this reason,
the PHP function <em>is_numeric()</em> is used.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="number" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="NumberValidator"
      button="send"
      control="number"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-3-EMailValidator"></a><h5>4.1.3. EMailValidator</h5>
The <strong>EMailValidator</strong> checks whether the referenced form control contains a valid
email address. For this reason, the content of the text field is checked against a regular expression.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="EMailValidator"
      button="send"
      control="email"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-4-PhoneAndFaxValidator"></a><h5>4.1.4. PhoneAndFaxValidator</h5>
The <strong>PhoneAndFaxValidator</strong> checks whether a form field contains a valid phone or
fax number. For this reason, the content of the text field is checked against a regular expression.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="phone" /&gt;
   &lt;form:text name="fax" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="PhoneAndFaxValidator"
      button="send"
      control="phone|fax"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-5-FieldCompareValidator"></a><h5>4.1.5. FieldCompareValidator</h5>
With the <strong>FieldCompareValidator</strong> you are enabled to compare the content of two text
fields. If the content of both controls is equal, the fields ara makred valid.
<br />
<br />
Due to the fact, that an APF form validator must be added to one dedicated control (due to observer
implementation), the main control must define the reference on the control, that can be used to
double check the content. For this reason, the <strong>ref</strong> attribute within the main
control definition must refer to the field, that is defined for the comparison check.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:password name="pass" ref="pass2" /&gt;
   &lt;form:password name="pass2" /&gt;
   &lt;form:addvalidator
      class="FieldCompareValidator"
      control="pass"
      button="login"
   /&gt;
   &lt;form:button name="login" value="login" /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-6-FolderValidator"></a><h5>4.1.6. FolderValidator</h5>
The <strong>FolderValidator</strong> belongs to the group of text field validators. It checks, whether
a text field contains a valid folder path.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="rootfolder" /&gt;
   &lt;form:text name="fax" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="FolderValidator"
      button="send"
      control="rootfolder"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-7-SimpleBirthdayValidator"></a><h5>4.1.7. SimpleBirthdayValidator</h5>
The <strong>SimpleBirthdayValidator</strong> is also belonging to the group of text field validators
and checks the content of a text field to contain a date definition that matches the pattern
<strong>dd.MM.YYYY</strong>.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="birthday" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleBirthdayValidator"
      button="send"
      control="birthday"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-8-DefaultSelectFieldValidator"></a><h5>4.1.8. DefaultSelectFieldValidator</h5>
The <strong>DefaultSelectFieldValidator</strong> can be added to select fields. It checks, if the
selected content is not empty (=no option selected). Please note, that this validator may only be
used with select fields, that are defined statically (with an explicit set of options). To validate
dynamic select fields, please use the <strong>SimpleSelectControlValidator</strong>.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:select name="color"&gt;
      &lt;select:option value=""&gt;&lt;/select:option&gt;
      &lt;select:option value="red"&gt;Red color&lt;/select:option&gt;
      &lt;select:option value="green"&gt;Green color&lt;/select:option&gt;
   &lt;/form:select&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="DefaultSelectFieldValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-9-SimpleSelectControlValidator"></a><h5>4.1.9. SimpleSelectControlValidator</h5>
The <strong>SimpleSelectControlValidator</strong> validates static and dynamic text fields (=options
are filled within a document controller). The validator checks, if the selected content is not
empty.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:select name="color"&gt;
      &lt;select:option value=""&gt;&lt;/select:option&gt;
      &lt;select:option value="red"&gt;Red color&lt;/select:option&gt;
      &lt;select:option value="green"&gt;Green color&lt;/select:option&gt;
   &lt;/form:select&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleSelectControlValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-10-MultiSelectFieldValidator"></a><h5>4.1.10. MultiSelectFieldValidator</h5>
The <strong>MultiSelectFieldValidator</strong> is the pendant to the
<strong>SimpleSelectControlValidator</strong> but validates multi select fields. It checks the
target element to have at least one option selected.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:multiselect name="colors"&gt;
      &lt;select:option value="red"&gt;Red color&lt;/select:option&gt;
      &lt;select:option value="green"&gt;Green color&lt;/select:option&gt;
   &lt;/form:multiselect&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="MultiSelectFieldValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-11-SimpleRadioControlValidator"></a><h5>4.1.11. SimpleRadioControlValidator</h5>
Using the <strong>SimpleRadioControlValidator</strong>, a radio button as well as a radio button
group can be checked. The validator thus expects, that at one button out of a group is selected. The
validator can be used for static and dynamic form definitions.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:radio id="red" name="color" /&gt; Red color
   &lt;form:radio id="green" name="color" /&gt; Green color
   &lt;form:radio id="blue" name="color" /&gt; Blue color
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleRadioControlValidator"
      button="send"
      control="color"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-1-11-SimpleDateControlValidator"></a><h5>4.1.11. SimpleDateControlValidator</h5>
The <strong>SimpleDateControlValidator</strong> validates the date control described in chapter
3.14. It requires the date to be greater or equal to today's date..
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:date name="birthday" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addvalidator
      class="SimpleDateControlValidator"
      button="send"
      control="birthday"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="4-2-Construction-of-validators"></a><h4>4.2. Construction of validators</h4>
Validators are classes, that are derived from <strong>AbstractFormValidator</strong>. This abstract
base class defines the structure of all form validators. This is necessary to be able to apply all
validators to form controls as an observer.
<br />
<br />
The interface is as follows:
<php:highlight>
abstract class AbstractFormValidator extends coreObject {

   protected $__Control;
   protected $__Button;

   public function AbstractFormValidator(form_control &$control,form_control &$button){
      $this->__Control = &$control;
      $this->__Button = &$button;
   }

   public abstract function validate($input);

   public abstract function notify();

   public function isActive(){
      return $this->__Button->isSent();
   }

}
</php:highlight>
The constructor takes the control to validate and the button that triggers the element as arguments.
The <strong>validate()</strong> method is applied the content to check against the logic the
validator includes. The return param is expected to be of type boolean indicating successful
validation (<em>true</em>) of failure (<em>false</em>).
<br />
<br />
The method <strong>notify()</strong> is called, when a form control could not be validated
successfully. It is intended to add css formatting to the desired form control, to fill place holders
or to apply changes to the DOM tree. In common, within this function the form fields are maked as
invalid using css style definitions and the listeners are notified.
<br />
<br />
The class members <strong>$__Control</strong> and <strong>$__Button</strong> contain the instance
of the form control to validate and the button, that is used as a trigger for the validation event.
Thus, these can easily be used within the validation code.
<br />
<br />
To be able to add a validator as an observer to a form control, the form control, must support this
operation. For this reason, each form element must implement the <strong>addValidator()</strong>
function. The signature of this method is defined within <strong>form_control</strong>:
<php:highlight>
public function addValidator(AbstractFormValidator &$validator){
   if($validator->isActive()){
      if(!$validator->validate($this->getAttribute('value'))){
         $validator->notify();
      }
   }
}
</php:highlight>
As the code snippet describes, the method takes an instance of the validator as an argument. In case,
the validator is active (=button is clicked) the validator is executed and on failure, the
<strong>notify()</strong> methode is called.
<br />
<br />
Further, the validator <em>by default</em> is passed the <strong>value</strong> of the tag, what is
only legal for text fields. Thus, non-text fields re-implement the method to pass the right content
to the validator.
<br />
<br />
<br />
<a name="4-3-Implementation-of-validators"></a><h4>4.3. Implementation of validators</h4>
As mentioned in the last chapters, a validator must inherit from the
<strong>AbstractFormValidator</strong> class. Besides, the APF includes two more base classes, that
can be used to implement text field or select box validators:
<ul>
   <li><strong>TextFieldValidator:</strong> Base class for all text field validators</li>
   <li><strong>SelectFieldValidator:</strong> Base class for all select box validators</li>
</ul>
These include the functionality to mark the desired form elements as invalid and notify the
validation event listeners.
<br />
<br />
In order to implement custom validators, please remember the following topics:
<ul>
   <li>Each validator must inherit from the <strong>AbstractFormValidator</strong> class.</li>
   <li>
      The method <strong>markAsInvalid()</strong> can be used to mark a form element as invalid.
   </li>
   <li>
      The method <strong>markAsInvalid()</strong> can be used to inform validation listeners.
   </li>
   <li>
      Using the button's <strong>isSent()</strong> method, you can decide, whether the form was
      sent or not.
   </li>
</ul>
<br />
<a name="5-Filters"></a><h3>5. Filters</h3>
In the previous versions of the APF the filters were linked directly with a form element and
executed within the
<a href="./?Page=098-Pagecontroller#2-1-Activity-diagram" title="Taglib lifecycle of the page controller">lifecycle of the taglibs</a>.
This has the disadvantage, that one element can be defined with only one filter. This leads to
redundant code, because each field must have it's own filter defined.
<br />
<br />
From version 1.11 these circumstances were considered and the form taglibs were moved to a new
variation of the filter facility. Thus, filters can be added as observers just like form validators
can be defined.
<br />
<br />
<div class="hint">
   Filtering of form elements is executed <strong>before</strong> validation to avoid positive
   validation due to removed characters during filtering. This is especially relevant for the
   <strong>TextLengthValidator</strong>.
</div>
<br />
The definition of a filter now is as follows:
<code:highlight>
&lt;form:addfilter
   namespace=""
   class=""
   button=""
   control=""
/&gt;
</code:highlight>
<strong>Description of the attributes:</strong>
<ul>
  <li>
    <strong>namespace</strong>: Namespace of the tilter implementation.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9:]</code>)
  </li>
  <li>
    <strong>class</strong>: Name of the tilter implementation (name = class name!)
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9_]</code>)
  </li>
  <li>
    <strong>button</strong>: Name of the button, that triggers the filter event. Filtering is
    executed, when the <em>isSent</em> event is fired by a button or an image button.
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_]</code>)
  </li>
  <li>
    <strong>control</strong>: Name of the form control to filter. In case, multiple controls
    should be allocated the same filter by only one tag definition, the attribute can contain a
    pipe-separated list of form controls (e.g. <em>sender|recipient|subject</em>).
    (<strong>Allowed characters</strong>: <code>[A-Za-z0-9-_|]</code>)
  </li>
</ul>
<div class="hint">
   In case you are using shipped validators, the <strong>namespace</strong> attribute can be omitted.
   The taglib therefore uses <strong>tools::form::filter</strong> as the default value. Within this
   namespace, all validators described in chapter 5.1 are located there.
</div>
<br />
<br />
<a name="5-1-Available-filters"></a><h4>5.1. Available filters</h4>
As in previous releases, the APF shipps a couple of built-in filters. These usually cover the large
part of the demands. Should these not be enough, own filters can be implemented. This is described
in the next chapter.
<br />
<br />
Currently the following filters are available:
<br />
<br />
<br />
<a name="5-1-1-EMailFilter"></a><h5>5.1.1. EMailFilter</h5>
The <strong>EMailFilter</strong> removes all characters, that must not be contained in a valid email
address.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="email" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="EMailFilter"
      button="send"
      control="email"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-2-NoSpecialCharactersFilter"></a><h5>5.1.2. NoSpecialCharactersFilter</h5>
The <strong>NoSpecialCharactersFilter</strong> filters all characters, that to not comply with the
regexp <strong>[^0-9A-Za-z-_\.& ]</strong>.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="simplechars" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="NoSpecialCharactersFilter"
      button="send"
      control="simplechars"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-3-OnlyHTMLEntitiesFilter"></a><h5>5.1.3. OnlyHTMLEntitiesFilter</h5>
Using the <strong>OnlyHTMLEntitiesFilter</strong> you can encode all special characters into their
HTML entity. Please note, that this filter may generate multiple encoding.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="htmlentitiestext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyHTMLEntitiesFilter"
      button="send"
      control="htmlentitiestext"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-4-OnlyIntegersFilter"></a><h5>5.1.4. OnlyIntegersFilter</h5>
The <strong>OnlyIntegersFilter</strong> only returns the numbers contained in the given text.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="zipcode" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyIntegersFilter"
      button="send"
      control="zipcode"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-5-OnlyLettersFilter"></a><h5>5.1.5. OnlyLettersFilter</h5>
The <strong>OnlyLettersFilter</strong> removes all signs except normal characters.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="productcode" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyLettersFilter"
      button="send"
      control="productcode"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-6-OnlyNumbersFilter"></a><h5>5.1.6. OnlyNumbersFilter</h5>
The <strong>OnlyNumbersFilter</strong> only allows numbers and formatting signs such as dots or
commas.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:text name="productprice" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="OnlyNumbersFilter"
      button="send"
      control="productprice"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-7-SpecialCharacterFilter"></a><h5>5.1.7. SpecialCharacterFilter</h5>
The <strong>SpecialCharacterFilter</strong> filters all signs except normal characters and signs that
are needed for normal sentences.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:area name="simpletext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="SpecialCharacterFilter"
      button="send"
      control="simpletext"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-8-String2LowerFilter"></a><h5>5.1.8. String2LowerFilter</h5>
The <strong>String2LowerFilter</strong> converts all characters to lowercase letters.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:area name="lowertext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="String2LowerFilter"
      button="send"
      control="lowertext"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-9-String2UpperFilter"></a><h5>5.1.9. String2UpperFilter</h5>
The <strong>String2UpperFilter</strong> converts all characters to uppercase letters.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:area name="uppertext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="String2LowerFilter"
      button="send"
      control="uppertext"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-1-10-StripTagsFilter"></a><h5>5.1.10. StripTagsFilter</h5>
Using the <strong>StripTagsFilter</strong> all HTML and PHP code fragments are filtered out. This
is especially good for text areas.
<code:highlight>
&lt;html:form name="..."&gt;
   &lt;form:area name="notagstext" /&gt;
   &lt;form:button name="send" value="Send"/&gt;
   &lt;form:addfilter
      class="StripTagsFilter"
      button="send"
      control="notagstext"
   /&gt;
&lt;/html:form&gt;
</code:highlight>
<br />
<a name="5-2-Construction-of-filters"></a><h4>5.2. Construction of filters</h4>
Form filters are special filters, that are built on the APF filter API described in detail in chapter
<a href="./?Page=087-Filter#4-Design-and-function" title="">design and function of filters</a>.
Each form filter must implement the <strong>AbstractFormFilter</strong> class that acts as an
interface for dedicated form filter implementations.
<br />
<br />
Just like the form validators, form filters must implement some form-specific methods. The
<strong>AbstractFormFilter</strong> interface class is as follows:
<php:highlight>
abstract class AbstractFormFilter extends AbstractFilter {

   protected $__Control;
   protected $__Button;

   public function AbstractFormFilter(form_control &$control,form_control &$button){
      $this->__Control = &$control;
      $this->__Button = &$button;
   }

   public function isActive(){
      return $this->__Button->isSent();
   }

}
</php:highlight>
The constructor takes the control to filter and the button that triggers the element as arguments.
The <strong>filter()</strong> method is applied the content to filter included in the method. The
return param is expected to be the filtered content.
<br />
<br />
<strong>isActive()</strong> returns <em>true</em> in case the filter should be executed and
<em>false</em> otherwise.
<br />
<br />
The class members <strong>$__Control</strong> and <strong>$__Button</strong> contain the instance of
the form control to filter and the button, that is used as a trigger for the validation event. Thus,
these can easily be used within the filter code.
<br />
<br />
To be able to add a filter as an observer to a form control, the form control, must support this
operation. For this reason, each form element must implement the <strong>addFilter()</strong>
function. The signature of the method defined within the <strong>form_control</strong> class is as
follows:
<php:highlight>
public function addFilter(AbstractFormFilter &$filter){
   if($filter->isActive()){
      $value = $this->getAttribute('value');
      $filteredValue = $filter->filter($value);
      $this->setAttribute('value',$filteredValue);
   }
}
</php:highlight>
As the code snippet describes, the method takes an instance of the filter as an argument. In case,
the filter is active (=button is clicked) the filter is executed.
<br />
<br />
Further, the filter is passed the content of the <strong>value</strong> attribute of the form control
<em>by default</em>. Thus, non-text fields re-implement the method to pass the right content to the
filter.
<br />
<br />
<div class="hint">
   Filters are usually applied on text fields. It is not recommended to apply filters to complex
   data structures and in case of select fields it may not be necessary at all. There, the content
   of the fields are filled by the application itself. Hence, the APF does not ship select field
   filters.
</div>
<br />
<br />
<a name="5-3-Implementation-of-filters"></a><h4>5.3. Implementation of filters</h4>
As mentioned in the last chapters, a filter  must inherit from the <strong>AbstractFormFilter</strong>
class.
<br />
<br />
In order to implement custom filters, please remember the following topics:
<ul>
   <li>
      Each filter must inherit from the <strong>AbstractFormFilter</strong> class to be compatible
      with the APF filter API.
   </li>
   <li>
      The <strong>isSent()</strong> method can be used to query the click status of a given button
      within the desired form.
   </li>
   <li>
      The <strong>isActive()</strong> can be used to check, whether a filter is active or not. In
      most cases, the implementation defined within the <strong>AbstractFormFilter</strong> can be
      used without adaption.
   </li>
</ul>
<div class="hint">
   Due to the fact, that with PHP >=5.2.10 and >=5.3.0 respectively, the signatures of abstract
   methods must be exactly equal to their implementations. Thus, please ensure, that the filter
   classes have a method <em>public function filter($input)</em> defined as printed here literally!
</div>
<br />
<br />
<a name="6-Usage-of-forms"></a><h3>6. Usage of forms</h3>
Chapter <a href="./?Page=114-Usage-of-forms" title="Usage of forms">usage of forms</a> deals with
the usage of APF forms and the form handling using document controller. The present page is only
intended as a reference for the shipped tags and the implementation of validators and filters.
Further, the linked chapter discusses dynamic form implementation.
<br />
<br />
<br />
<core:importdesign namespace="modules::comments::pres::templates" template="comment" categorykey="en_113" />