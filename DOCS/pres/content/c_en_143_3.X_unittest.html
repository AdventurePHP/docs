<doku:title parent="119" tags="unittest,phpunit,test driven development,tdd,continuous integration,continuous development" title="Unittest" urlname="Unittest">
  The following content describes the usage of unit tests/component tests for the
  Adventure PHP Framework with PHPUnit.
</doku:title>

<h3 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction">1. Introduction</a></h3>
    PHPUnit is a framework to build unit tests and run them
    automatically from the commandline. Single tests up to whole test suites (a bunch 
    of tests, organized through a configuration file) are possible and will improve
    the stability and maintainability of every application. It is a fundamentally
    part of a continues development, to run existing tests more then once to check if
    changes had influence on parts of the system you did not thought of. There is a
    lot more you can to with PHPUnit, but that's the core function. 
<br />
<br />
<br />

<h3 id="Chapter-2-Installation"><a href="#Chapter-2-Installation">2. Installation</a></h3>
<p>
    The requirement to run unit tests with the Adventure PHP Framework is the PHPUnit
    framework. It is freely available through several sources. The following
    section explains two ways to get the phpunit framework.
</p>

<h3 id="Chapter-2-1-PEAR"><a href="#Chapter-2-1-PEAR">2. Installation via PEAR</a></h3>
<p>
    A convenient way to get the phpunit framework is PEAR. The PEAR CLI provides
    an easy way to install and update your packages. Most all-in-one solutions 
    like XAMPP provide at least the PEAR installer, if not already have pre-installed 
    some PEAR packages. In the following sections it will be assumed a pear 
    environment is correctly installed, you can get more information under
    <a href="http://pear.php.net/manual/en/installation.php" title="PEAR-Installation">PEAR-Installation</a>.
</p>

<p>
    The <a href="http://www.phpunit.de/manual/3.6/en/installation.html" title="Installation PHPUnit-Framework">installation of the PHPUnit-Framework</a> 
    now proceeds easily and quickly. Therefor call the command line and enter the
    following commands:
</p>

<gen:highlight type="shell">
pear config-set auto_discover 1
pear install pear.phpunit.de/File_Iterator
pear install pear.phpunit.de/Text_Template
pear install pear.phpunit.de/PHP_CodeCoverage
pear install pear.phpunit.de/PHP_Timer
pear install pear.phpunit.de/PHPUnit_MockObject
pear install pear.phpunit.de/PHPUnit
</gen:highlight>

<p>
    The following packages are optional:
</p>

<gen:highlight type="shell">
pear install phpunit/DbUnit
pear install phpunit/PHPUnit_Selenium
pear install phpunit/PHPUnit_Story
pear install phpunit/PHPUnit_TestListener_DBUS
pear install phpunit/PHPUnit_TestListener_XHProf
pear install phpunit/PHPUnit_TicketListener_Fogbugz
pear install phpunit/PHPUnit_TicketListener_GitHub
pear install phpunit/PHPUnit_TicketListener_GoogleCode
pear install phpunit/PHPUnit_TicketListener_Trac
pear install phpunit/PHP_Invoker
</gen:highlight>


<h3 id="Chapter-2-1-GIT"><a href="#Chapter-2-1-GIT">2. Installation via GIT</a></h3>
<p>
    The second possibility to get the phpunit framework is via GIT. You get more
    information under the <a href="https://github.com/sebastianbergmann/phpunit/blob/master/README.markdown" title="PHPUnit via GIT">official introduction</a>.
    If you have a git client installed, you can use the following commands on the
    command line:
</p>

<gen:highlight type="shell">
mkdir phpunit && cd phpunit
git clone git://github.com/sebastianbergmann/phpunit.git
git clone git://github.com/sebastianbergmann/dbunit.git
git clone git://github.com/sebastianbergmann/php-file-iterator.git
git clone git://github.com/sebastianbergmann/php-text-template.git
git clone git://github.com/sebastianbergmann/php-code-coverage.git
git clone git://github.com/sebastianbergmann/php-token-stream.git
git clone git://github.com/sebastianbergmann/php-timer.git
git clone git://github.com/sebastianbergmann/phpunit-mock-objects.git
git clone git://github.com/sebastianbergmann/phpunit-selenium.git
git clone git://github.com/sebastianbergmann/phpunit-story.git
git clone git://github.com/sebastianbergmann/php-invoker.git
</gen:highlight>



<h3 id="Chapter-3-Configuration"><a href="#Chapter-3-Configuration">3. Configuraton</a></h3>
<p>
   If you have the PHPUnit framework installed, there is not much to do to finally 
   bring the unit tests on the Adventure PHP Framework to work.
</p>

<p>
    First you change directory to <em>tests</em>. There are two files, which
    has to be copied and renamed:
</p>

<gen:highlight type="shell">
cp phpunit.dist.xml phpunit.xml
cp phpunit.dist phpunit
</gen:highlight>

<p>
    The file "phpunit" is the script to call on commandline to invoke the phpunit 
    test application. Before you can use it correctly, you need to open the file and
    change the fist constant called PHPUNIT_INCLUDE_PATH, which has the path to the
    shared pear library. On Windows based systems you may change the second constant
    PHP_BIN_FILENAME to "php.exe".
</p>



<h3 id="Chapter-4-Execution"><a href="#Chapter-4-Execution">4. Execution</a></h3>
<p>
    Now you may call the script <em>phpunit</em> in the directory <em>../branches/php5/1.15/tests/</em>
    from the commandline with the following command:
</p>

<gen:highlight type="shell">
php phpunit
</gen:highlight>

<p>
    The script automatically checks for the default configuration file called
    "phpunit.xml" which we have already existing in the current directory.<br/>
    So if everything works correctly the script should call the described test 
    suites from the configuration file.
</p>


<h3 id="Chapter-5-Custom-Unit-Tests"><a href="#Chapter-5-Custom-Unit-Tests">5. Custom Unit Tests</a></h3>
<p>
   If you want to run you own tests or extend the existing, all you have to do is
    adding it to the configuration file, and of course write the test.
</p>
<div class="hint">
   In order to configure <a class="external" href="http://www.jetbrains.com/phpstorm/">PHPStorm</a> for development and
   execution of APF UnitTests please follow the instructions of the wiki article
   <a class="wiki" href="${getBaseUrl(WikiBaseURL)}/Setup_UnitTest-Umgebung_in_PHPStorm">Setup UnitTest-Umgebung in PHPStorm</a>
   (German).
</div>

<core:importdesign namespace="APF\modules\comments\pres\templates" template="comment" categorykey="en_143" />