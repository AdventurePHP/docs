<doku:title parent="100" tags="migration,2.0,2.1,extended templating" title="Migration from 2.0 to 2.1" urlname="Migration-from-2-0-to-2-1">
   This page describes the adaptions of your current software (up to and including release 2.0) necessary to upgrade it
   to release 2.1.
</doku:title>
<h3 id="Chapter-1-Introduction"><a href="#Chapter-1-Introduction">1. Introduction</a></h3>
<p>
   Version 2.1. is the second release of the <em>2.X</em> series. It contains lots of new features and optimizations.
   Besides, it fixes some issues of version 2.0.
</p>
<p>
   To run your application based on the new version small adaptions are necessary to your configuration files. To ease
   change the new version ships an automated migration and a tool to separate application from framework code.
</p>
<p>
   The below chapters contain an in-depth description on how to switch to APF 2.1 and which kind of changes have to be
   applied to your existing application(s) to run them based on this version.
</p>

<h3 id="Chapter-2-Automated-migration"><a href="#Chapter-2-Automated-migration">2. Automated migration</a></h3>
<p>
   As you might already be familiar with from release 2.0 migration can be done using the migration script shipped along
   with the release. This release includes changes to configuration files. Using <em>migrate-config.sh</em> you can
   easily be adapted your existing application to the new scheme.
</p>
<div class="warn">
   Please be sure to execute all steps described under <int:link pageid="156" />. In case you are using an order version
   of the APF, please <em>completely</em> migrate to version 2.0. Instructions can be taken from <int:link pageid="100" />.
</div>
<p>
   In case your development environment is windows, please install the latest <em>cygwin</em> version (download under
   <a class="external" href="http://cygwin.com/install.html">cygwin.com</a>). Migration for Windows Batch Scripts is
   not supported.
</p>
<p>
   To update the configuration files to the latest scheme, please execute the script as follows:
</p>
<div class="warn">
   Please change to the configuration directory before execution to avoid unexpected results.
</div>
<gen:highlight type="code">
$ cd /path/to/my/config
$ ../migration/migrate-config.sh /cygdrive/c/xampp/php/php
#############################################
# APF 2.1 automatic configuration migration #
#############################################

Checking PHP executable available ... [OK]

Using given php executable at /cygdrive/c/xampp/php/php. PHP Version: 5.4.16.

#############################################

Starting configuration migration ...
* Front controller configuration files ...
* Database configuration files ...

#############################################

Migration done! Please check your configuration and follow instructions within migration documentation!
</gen:highlight>

<h4 id="Chapter-3-Manual-migration"><a href="#Chapter-3-Manual-migration">3. Manual migration</a></h4>
<p>
   Unfortunately, not all components of your application can be migrated by the delivered scripts. This chapter lists
   all changes to be applied by hand.
</p>
<p>
   Implementation of feature request <a href="http://tracker.adventure-php-framework.org/view.php?id=171" class="external">ID#171</a>
   changed the transformation logic of DOM nodes. This means that the the content of the DOM note under transformation
   no longer is injected to the document controller field
</p>
<gen:highlight type="php">
$this->content
</gen:highlight>
<p>
   For this reason, you can no longer access it using
</p>
<gen:highlight type="php">
$this->getContent()
</gen:highlight>
<p>
   To access the content of the current DOM node, please refer to the current document via
</p>
<gen:highlight type="php">
$this->getDocument()
</gen:highlight>
<p>
   Given the <em>Document</em> instance you can then query the content by
</p>
<gen:highlight type="php">
$this->getDocument()->getContent()
</gen:highlight>
<p>
   or manipulate it with
</p>
<gen:highlight type="php">
$this->getDocument()->setContent(...)
</gen:highlight>
<div class="warn">
   Please note that manipulation of DOM node content may lead to unexpected behaviour. Thus it is not recommended to
   change content within document controllers.
</div>

<core:importdesign namespace="APF\modules\comments\pres\templates" template="comment" categorykey="en_157" />